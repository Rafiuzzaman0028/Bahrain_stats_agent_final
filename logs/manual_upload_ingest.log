[2025-11-29 09:08:18] Starting ingest: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\venv\Scripts\python.exe C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py --run --dry
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
[ingest] Loaded schema overrides from C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\config\schemas.json
[ingest] Running ingest (dry=True) - incoming dir: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-sectoral-recruitment.csv
{
  "file": "01-sectoral-recruitment.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 80,
    "rows_before": 644,
    "rows_after": 360
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-workers-registered-at-civil-service-bureau.csv
{
  "file": "01-workers-registered-at-civil-service-bureau.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 568,
    "rows_before": 644,
    "rows_after": 924
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-area-by-island-2023.csv
{
  "file": "03-area-by-island-2023.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 36,
    "rows_before": 644,
    "rows_after": 392
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-expenditure-per-visitor.csv
{
  "file": "03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 644,
    "rows_after": 452
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\05-health-labour-force-by-sex.csv
{
  "file": "05-health-labour-force-by-sex.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 60,
    "rows_before": 644,
    "rows_after": 416
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\06-number-of-protected-homes.csv
{
  "file": "06-number-of-protected-homes.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "number": "count",
    "n": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 10,
    "rows_before": 20,
    "rows_after": 28
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value (1).csv
{
  "file": "09-annually-compensation-of-employees-cp-value (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 644,
    "rows_after": 664
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value.csv
{
  "file": "09-annually-compensation-of-employees-cp-value.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 644,
    "rows_after": 664
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\22-deaths-by-age-groups.csv
{
  "file": "22-deaths-by-age-groups.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 1748,
    "rows_before": 644,
    "rows_after": 2104
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system (1).csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 644,
    "rows_after": 644
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system.csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 644,
    "rows_after": 644
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-current-usage-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-ownership-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings.csv
{
  "file": "buildings.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 773,
    "rows_before": 1953,
    "rows_after": 1953
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment.csvC:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)

{
  "file": "change-in-the-number-of-recruitment.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "change_in_the_number_of_recruitment": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 18
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-households-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-of-average-households-by-governorate-and-nationality-of-households-.csv
{
  "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-population-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\estimated-workers.csv
{
  "file": "estimated-workers.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 32,
    "rows_before": 644,
    "rows_after": 356
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\health-services.csv
{
  "file": "health-services.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 587,
    "rows_before": 1953,
    "rows_after": 1953
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\hotels-and-apartments.csv
{
  "file": "hotels-and-apartments.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 714,
    "rows_before": 1953,
    "rows_after": 1953
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-governorate-census-2020.csv
{
  "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "governorate": "governorate",
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-occupancy-census-2020 (2).csv
{
  "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\job-seekers.csv
{
  "file": "job-seekers.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 22
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate.csv
{
  "file": "lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv
{
  "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 28,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\number-of-job-seekers-by-highest-education-level.csv
{
  "file": "number-of-job-seekers-by-highest-education-level.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 12,
    "rows_before": 20,
    "rows_after": 20
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv
{
  "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-governorate-and-household-nationality-census-2020.csv
{
  "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-governorate-census-2020.csv
{
  "file": "private-households-by-household-size-and-governorate-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-housing-type-census-2020.csv
{
  "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020 (1).csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020.csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\value-of-welfare-payments.csv
{
  "file": "value-of-welfare-payments.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 99,
    "rows_before": 644,
    "rows_after": 364
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\work-injuries-for-workers-covered-by-social-insurance-system.csv
{
  "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 644,
    "rows_after": 644
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv
{
  "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv
{
  "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Done. Summary:
[
  {
    "file": "01-sectoral-recruitment.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 80,
      "rows_before": 644,
      "rows_after": 360
    },
    "error": null
  },
  {
    "file": "01-workers-registered-at-civil-service-bureau.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 568,
      "rows_before": 644,
      "rows_after": 924
    },
    "error": null
  },
  {
    "file": "03-area-by-island-2023.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 36,
      "rows_before": 644,
      "rows_after": 392
    },
    "error": null
  },
  {
    "file": "03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 644,
      "rows_after": 452
    },
    "error": null
  },
  {
    "file": "05-health-labour-force-by-sex.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 60,
      "rows_before": 644,
      "rows_after": 416
    },
    "error": null
  },
  {
    "file": "06-number-of-protected-homes.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "number": "count",
      "n": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 10,
      "rows_before": 20,
      "rows_after": 28
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 644,
      "rows_after": 664
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 644,
      "rows_after": 664
    },
    "error": null
  },
  {
    "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "22-deaths-by-age-groups.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 1748,
      "rows_before": 644,
      "rows_after": 2104
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 644,
      "rows_after": 644
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 644,
      "rows_after": 644
    },
    "error": null
  },
  {
    "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-building-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 773,
      "rows_before": 1953,
      "rows_after": 1953
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "change_in_the_number_of_recruitment": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 18
    },
    "error": null
  },
  {
    "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "estimated-workers.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 32,
      "rows_before": 644,
      "rows_after": 356
    },
    "error": null
  },
  {
    "file": "health-services.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 587,
      "rows_before": 1953,
      "rows_after": 1953
    },
    "error": null
  },
  {
    "file": "hotels-and-apartments.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 714,
      "rows_before": 1953,
      "rows_after": 1953
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "governorate": "governorate",
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "job-seekers.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 22
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 28,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "number-of-job-seekers-by-highest-education-level.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 12,
      "rows_before": 20,
      "rows_after": 20
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-governorate-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "value-of-welfare-payments.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 99,
      "rows_before": 644,
      "rows_after": 364
    },
    "error": null
  },
  {
    "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 644,
      "rows_after": 644
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  }
]
[2025-11-29 09:08:24] Starting ingest: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\venv\Scripts\python.exe C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py --run --dry
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
[ingest] Loaded schema overrides from C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\config\schemas.json
[ingest] Running ingest (dry=True) - incoming dir: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-sectoral-recruitment.csv
{
  "file": "01-sectoral-recruitment.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 80,
    "rows_before": 644,
    "rows_after": 360
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-workers-registered-at-civil-service-bureau.csv
{
  "file": "01-workers-registered-at-civil-service-bureau.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 568,
    "rows_before": 644,
    "rows_after": 924
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-area-by-island-2023.csv
{
  "file": "03-area-by-island-2023.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 36,
    "rows_before": 644,
    "rows_after": 392
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-expenditure-per-visitor.csv
{
  "file": "03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 644,
    "rows_after": 452
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\05-health-labour-force-by-sex.csv
{
  "file": "05-health-labour-force-by-sex.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 60,
    "rows_before": 644,
    "rows_after": 416
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\06-number-of-protected-homes.csv
{
  "file": "06-number-of-protected-homes.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "number": "count",
    "n": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 10,
    "rows_before": 20,
    "rows_after": 28
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value (1).csv
{
  "file": "09-annually-compensation-of-employees-cp-value (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 644,
    "rows_after": 664
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value.csv
{
  "file": "09-annually-compensation-of-employees-cp-value.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 644,
    "rows_after": 664
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\22-deaths-by-age-groups.csv
{
  "file": "22-deaths-by-age-groups.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 1748,
    "rows_before": 644,
    "rows_after": 2104
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system (1).csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 644,
    "rows_after": 644
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system.csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 644,
    "rows_after": 644
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-current-usage-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-ownership-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)

[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings.csv
{
  "file": "buildings.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 773,
    "rows_before": 1953,
    "rows_after": 1953
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment.csv
{
  "file": "change-in-the-number-of-recruitment.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "change_in_the_number_of_recruitment": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 18
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-households-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-of-average-households-by-governorate-and-nationality-of-households-.csv
{
  "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-population-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\estimated-workers.csv
{
  "file": "estimated-workers.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 32,
    "rows_before": 644,
    "rows_after": 356
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\health-services.csv
{
  "file": "health-services.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 587,
    "rows_before": 1953,
    "rows_after": 1953
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\hotels-and-apartments.csv
{
  "file": "hotels-and-apartments.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 714,
    "rows_before": 1953,
    "rows_after": 1953
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-governorate-census-2020.csv
{
  "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "governorate": "governorate",
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-occupancy-census-2020 (2).csv
{
  "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\job-seekers.csv
{
  "file": "job-seekers.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 22
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate.csv
{
  "file": "lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv
{
  "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 28,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\number-of-job-seekers-by-highest-education-level.csv
{
  "file": "number-of-job-seekers-by-highest-education-level.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 12,
    "rows_before": 20,
    "rows_after": 20
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv
{
  "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-governorate-and-household-nationality-census-2020.csv
{
  "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-governorate-census-2020.csv
{
  "file": "private-households-by-household-size-and-governorate-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-housing-type-census-2020.csv
{
  "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020 (1).csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020.csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\value-of-welfare-payments.csv
{
  "file": "value-of-welfare-payments.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 99,
    "rows_before": 644,
    "rows_after": 364
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\work-injuries-for-workers-covered-by-social-insurance-system.csv
{
  "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 644,
    "rows_after": 644
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv
{
  "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv
{
  "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Done. Summary:
[
  {
    "file": "01-sectoral-recruitment.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 80,
      "rows_before": 644,
      "rows_after": 360
    },
    "error": null
  },
  {
    "file": "01-workers-registered-at-civil-service-bureau.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 568,
      "rows_before": 644,
      "rows_after": 924
    },
    "error": null
  },
  {
    "file": "03-area-by-island-2023.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 36,
      "rows_before": 644,
      "rows_after": 392
    },
    "error": null
  },
  {
    "file": "03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 644,
      "rows_after": 452
    },
    "error": null
  },
  {
    "file": "05-health-labour-force-by-sex.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 60,
      "rows_before": 644,
      "rows_after": 416
    },
    "error": null
  },
  {
    "file": "06-number-of-protected-homes.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "number": "count",
      "n": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 10,
      "rows_before": 20,
      "rows_after": 28
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 644,
      "rows_after": 664
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 644,
      "rows_after": 664
    },
    "error": null
  },
  {
    "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "22-deaths-by-age-groups.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 1748,
      "rows_before": 644,
      "rows_after": 2104
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 644,
      "rows_after": 644
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 644,
      "rows_after": 644
    },
    "error": null
  },
  {
    "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-building-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 773,
      "rows_before": 1953,
      "rows_after": 1953
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "change_in_the_number_of_recruitment": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 18
    },
    "error": null
  },
  {
    "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "estimated-workers.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 32,
      "rows_before": 644,
      "rows_after": 356
    },
    "error": null
  },
  {
    "file": "health-services.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 587,
      "rows_before": 1953,
      "rows_after": 1953
    },
    "error": null
  },
  {
    "file": "hotels-and-apartments.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 714,
      "rows_before": 1953,
      "rows_after": 1953
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "governorate": "governorate",
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "job-seekers.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 22
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 28,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "number-of-job-seekers-by-highest-education-level.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 12,
      "rows_before": 20,
      "rows_after": 20
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-governorate-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "value-of-welfare-payments.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 99,
      "rows_before": 644,
      "rows_after": 364
    },
    "error": null
  },
  {
    "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 644,
      "rows_after": 644
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  }
]
[2025-11-29 09:08:29] Starting ingest: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\venv\Scripts\python.exe C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py --run --dry
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
[ingest] Loaded schema overrides from C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\config\schemas.json
[ingest] Running ingest (dry=True) - incoming dir: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-sectoral-recruitment.csv
{
  "file": "01-sectoral-recruitment.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 80,
    "rows_before": 644,
    "rows_after": 360
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-workers-registered-at-civil-service-bureau.csv
{
  "file": "01-workers-registered-at-civil-service-bureau.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 568,
    "rows_before": 644,
    "rows_after": 924
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-area-by-island-2023.csv
{
  "file": "03-area-by-island-2023.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 36,
    "rows_before": 644,
    "rows_after": 392
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-expenditure-per-visitor.csv
{
  "file": "03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 644,
    "rows_after": 452
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\05-health-labour-force-by-sex.csv
{
  "file": "05-health-labour-force-by-sex.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 60,
    "rows_before": 644,
    "rows_after": 416
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\06-number-of-protected-homes.csv
{
  "file": "06-number-of-protected-homes.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "number": "count",
    "n": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 10,
    "rows_before": 20,
    "rows_after": 28
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value (1).csv
{
  "file": "09-annually-compensation-of-employees-cp-value (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 644,
    "rows_after": 664
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value.csv
{
  "file": "09-annually-compensation-of-employees-cp-value.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 644,
    "rows_after": 664
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\22-deaths-by-age-groups.csv
{
  "file": "22-deaths-by-age-groups.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 1748,
    "rows_before": 644,
    "rows_after": 2104
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system (1).csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 644,
    "rows_after": 644
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system.csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 644,
    "rows_after": 644
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-current-usage-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)

[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-ownership-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings.csv
{
  "file": "buildings.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 773,
    "rows_before": 1953,
    "rows_after": 1953
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment.csv
{
  "file": "change-in-the-number-of-recruitment.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "change_in_the_number_of_recruitment": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 18
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-households-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-of-average-households-by-governorate-and-nationality-of-households-.csv
{
  "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-population-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\estimated-workers.csv
{
  "file": "estimated-workers.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 32,
    "rows_before": 644,
    "rows_after": 356
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\health-services.csv
{
  "file": "health-services.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 587,
    "rows_before": 1953,
    "rows_after": 1953
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\hotels-and-apartments.csv
{
  "file": "hotels-and-apartments.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 714,
    "rows_before": 1953,
    "rows_after": 1953
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-governorate-census-2020.csv
{
  "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "governorate": "governorate",
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-occupancy-census-2020 (2).csv
{
  "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\job-seekers.csv
{
  "file": "job-seekers.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 22
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate.csv
{
  "file": "lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv
{
  "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 28,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\number-of-job-seekers-by-highest-education-level.csv
{
  "file": "number-of-job-seekers-by-highest-education-level.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 12,
    "rows_before": 20,
    "rows_after": 20
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv
{
  "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-governorate-and-household-nationality-census-2020.csv
{
  "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-governorate-census-2020.csv
{
  "file": "private-households-by-household-size-and-governorate-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-housing-type-census-2020.csv
{
  "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020 (1).csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020.csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\value-of-welfare-payments.csv
{
  "file": "value-of-welfare-payments.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 99,
    "rows_before": 644,
    "rows_after": 364
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\work-injuries-for-workers-covered-by-social-insurance-system.csv
{
  "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 644,
    "rows_after": 644
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv
{
  "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv
{
  "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Done. Summary:
[
  {
    "file": "01-sectoral-recruitment.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 80,
      "rows_before": 644,
      "rows_after": 360
    },
    "error": null
  },
  {
    "file": "01-workers-registered-at-civil-service-bureau.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 568,
      "rows_before": 644,
      "rows_after": 924
    },
    "error": null
  },
  {
    "file": "03-area-by-island-2023.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 36,
      "rows_before": 644,
      "rows_after": 392
    },
    "error": null
  },
  {
    "file": "03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 644,
      "rows_after": 452
    },
    "error": null
  },
  {
    "file": "05-health-labour-force-by-sex.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 60,
      "rows_before": 644,
      "rows_after": 416
    },
    "error": null
  },
  {
    "file": "06-number-of-protected-homes.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "number": "count",
      "n": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 10,
      "rows_before": 20,
      "rows_after": 28
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 644,
      "rows_after": 664
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 644,
      "rows_after": 664
    },
    "error": null
  },
  {
    "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "22-deaths-by-age-groups.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 1748,
      "rows_before": 644,
      "rows_after": 2104
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 644,
      "rows_after": 644
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 644,
      "rows_after": 644
    },
    "error": null
  },
  {
    "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-building-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 773,
      "rows_before": 1953,
      "rows_after": 1953
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "change_in_the_number_of_recruitment": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 18
    },
    "error": null
  },
  {
    "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "estimated-workers.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 32,
      "rows_before": 644,
      "rows_after": 356
    },
    "error": null
  },
  {
    "file": "health-services.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 587,
      "rows_before": 1953,
      "rows_after": 1953
    },
    "error": null
  },
  {
    "file": "hotels-and-apartments.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 714,
      "rows_before": 1953,
      "rows_after": 1953
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "governorate": "governorate",
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "job-seekers.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 22
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 28,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "number-of-job-seekers-by-highest-education-level.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 12,
      "rows_before": 20,
      "rows_after": 20
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-governorate-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "value-of-welfare-payments.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 99,
      "rows_before": 644,
      "rows_after": 364
    },
    "error": null
  },
  {
    "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 644,
      "rows_after": 644
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  }
]
[2025-11-29 09:08:37] Starting ingest: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\venv\Scripts\python.exe C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py --run --dry
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
[ingest] Loaded schema overrides from C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\config\schemas.json
[ingest] Running ingest (dry=True) - incoming dir: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-sectoral-recruitment.csv
{
  "file": "01-sectoral-recruitment.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 80,
    "rows_before": 644,
    "rows_after": 360
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-workers-registered-at-civil-service-bureau.csv
{
  "file": "01-workers-registered-at-civil-service-bureau.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 568,
    "rows_before": 644,
    "rows_after": 924
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-area-by-island-2023.csv
{
  "file": "03-area-by-island-2023.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 36,
    "rows_before": 644,
    "rows_after": 392
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-expenditure-per-visitor.csv
{
  "file": "03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 644,
    "rows_after": 452
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\05-health-labour-force-by-sex.csv
{
  "file": "05-health-labour-force-by-sex.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 60,
    "rows_before": 644,
    "rows_after": 416
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\06-number-of-protected-homes.csv
{
  "file": "06-number-of-protected-homes.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "number": "count",
    "n": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 10,
    "rows_before": 20,
    "rows_after": 28
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value (1).csv
{
  "file": "09-annually-compensation-of-employees-cp-value (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 644,
    "rows_after": 664
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value.csv
{
  "file": "09-annually-compensation-of-employees-cp-value.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 644,
    "rows_after": 664
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\22-deaths-by-age-groups.csv
{
  "file": "22-deaths-by-age-groups.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 1748,
    "rows_before": 644,
    "rows_after": 2104
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system (1).csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 644,
    "rows_after": 644
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system.csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 644,
    "rows_after": 644
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-current-usage-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)

[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-ownership-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings.csv
{
  "file": "buildings.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 773,
    "rows_before": 1953,
    "rows_after": 1953
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment.csv
{
  "file": "change-in-the-number-of-recruitment.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "change_in_the_number_of_recruitment": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 18
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-households-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-of-average-households-by-governorate-and-nationality-of-households-.csv
{
  "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-population-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\estimated-workers.csv
{
  "file": "estimated-workers.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 32,
    "rows_before": 644,
    "rows_after": 356
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\health-services.csv
{
  "file": "health-services.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 587,
    "rows_before": 1953,
    "rows_after": 1953
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\hotels-and-apartments.csv
{
  "file": "hotels-and-apartments.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 714,
    "rows_before": 1953,
    "rows_after": 1953
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-governorate-census-2020.csv
{
  "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "governorate": "governorate",
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-occupancy-census-2020 (2).csv
{
  "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\job-seekers.csv
{
  "file": "job-seekers.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 22
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate.csv
{
  "file": "lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv
{
  "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 28,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\number-of-job-seekers-by-highest-education-level.csv
{
  "file": "number-of-job-seekers-by-highest-education-level.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 12,
    "rows_before": 20,
    "rows_after": 20
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv
{
  "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-governorate-and-household-nationality-census-2020.csv
{
  "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-governorate-census-2020.csv
{
  "file": "private-households-by-household-size-and-governorate-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-housing-type-census-2020.csv
{
  "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020 (1).csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020.csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\value-of-welfare-payments.csv
{
  "file": "value-of-welfare-payments.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 99,
    "rows_before": 644,
    "rows_after": 364
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\work-injuries-for-workers-covered-by-social-insurance-system.csv
{
  "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 644,
    "rows_after": 644
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv
{
  "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv
{
  "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Done. Summary:
[
  {
    "file": "01-sectoral-recruitment.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 80,
      "rows_before": 644,
      "rows_after": 360
    },
    "error": null
  },
  {
    "file": "01-workers-registered-at-civil-service-bureau.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 568,
      "rows_before": 644,
      "rows_after": 924
    },
    "error": null
  },
  {
    "file": "03-area-by-island-2023.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 36,
      "rows_before": 644,
      "rows_after": 392
    },
    "error": null
  },
  {
    "file": "03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 644,
      "rows_after": 452
    },
    "error": null
  },
  {
    "file": "05-health-labour-force-by-sex.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 60,
      "rows_before": 644,
      "rows_after": 416
    },
    "error": null
  },
  {
    "file": "06-number-of-protected-homes.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "number": "count",
      "n": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 10,
      "rows_before": 20,
      "rows_after": 28
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 644,
      "rows_after": 664
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 644,
      "rows_after": 664
    },
    "error": null
  },
  {
    "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "22-deaths-by-age-groups.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 1748,
      "rows_before": 644,
      "rows_after": 2104
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 644,
      "rows_after": 644
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 644,
      "rows_after": 644
    },
    "error": null
  },
  {
    "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-building-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 773,
      "rows_before": 1953,
      "rows_after": 1953
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "change_in_the_number_of_recruitment": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 18
    },
    "error": null
  },
  {
    "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "estimated-workers.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 32,
      "rows_before": 644,
      "rows_after": 356
    },
    "error": null
  },
  {
    "file": "health-services.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 587,
      "rows_before": 1953,
      "rows_after": 1953
    },
    "error": null
  },
  {
    "file": "hotels-and-apartments.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 714,
      "rows_before": 1953,
      "rows_after": 1953
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "governorate": "governorate",
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "job-seekers.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 22
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 28,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "number-of-job-seekers-by-highest-education-level.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 12,
      "rows_before": 20,
      "rows_after": 20
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-governorate-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "value-of-welfare-payments.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 99,
      "rows_before": 644,
      "rows_after": 364
    },
    "error": null
  },
  {
    "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 644,
      "rows_after": 644
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  }
]
[2025-11-29 09:20:43] Starting ingest: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\venv\Scripts\python.exe C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py --run --dry
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
[ingest] Loaded schema overrides from C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\config\schemas.json
[ingest] Running ingest (dry=True) - incoming dir: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-sectoral-recruitment.csv
{
  "file": "01-sectoral-recruitment.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 80,
    "rows_before": 644,
    "rows_after": 360
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-workers-registered-at-civil-service-bureau.csv
{
  "file": "01-workers-registered-at-civil-service-bureau.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 568,
    "rows_before": 644,
    "rows_after": 924
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-area-by-island-2023.csv
{
  "file": "03-area-by-island-2023.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 36,
    "rows_before": 644,
    "rows_after": 392
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-expenditure-per-visitor.csv
{
  "file": "03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 644,
    "rows_after": 452
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\05-health-labour-force-by-sex.csv
{
  "file": "05-health-labour-force-by-sex.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 60,
    "rows_before": 644,
    "rows_after": 416
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\06-number-of-protected-homes.csv
{
  "file": "06-number-of-protected-homes.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "number": "count",
    "n": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 10,
    "rows_before": 20,
    "rows_after": 28
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value (1).csv
{
  "file": "09-annually-compensation-of-employees-cp-value (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 644,
    "rows_after": 664
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value.csv
{
  "file": "09-annually-compensation-of-employees-cp-value.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 644,
    "rows_after": 664
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\22-deaths-by-age-groups.csv
{
  "file": "22-deaths-by-age-groups.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 1748,
    "rows_before": 644,
    "rows_after": 2104
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system (1).csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 644,
    "rows_after": 644
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system.csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 644,
    "rows_after": 644
  },
  "error": null
}C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)

[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-current-usage-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-ownership-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings.csv
{
  "file": "buildings.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 773,
    "rows_before": 1953,
    "rows_after": 1953
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment.csv
{
  "file": "change-in-the-number-of-recruitment.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "change_in_the_number_of_recruitment": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 18
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-households-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-of-average-households-by-governorate-and-nationality-of-households-.csv
{
  "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-population-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\estimated-workers.csv
{
  "file": "estimated-workers.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 32,
    "rows_before": 644,
    "rows_after": 356
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\health-services.csv
{
  "file": "health-services.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 587,
    "rows_before": 1953,
    "rows_after": 1953
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\hotels-and-apartments.csv
{
  "file": "hotels-and-apartments.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 714,
    "rows_before": 1953,
    "rows_after": 1953
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-governorate-census-2020.csv
{
  "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "governorate": "governorate",
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-occupancy-census-2020 (2).csv
{
  "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\job-seekers.csv
{
  "file": "job-seekers.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 22
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate.csv
{
  "file": "lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv
{
  "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 28,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\number-of-job-seekers-by-highest-education-level.csv
{
  "file": "number-of-job-seekers-by-highest-education-level.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 12,
    "rows_before": 20,
    "rows_after": 20
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv
{
  "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-governorate-and-household-nationality-census-2020.csv
{
  "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-governorate-census-2020.csv
{
  "file": "private-households-by-household-size-and-governorate-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-housing-type-census-2020.csv
{
  "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020 (1).csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020.csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\value-of-welfare-payments.csv
{
  "file": "value-of-welfare-payments.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 99,
    "rows_before": 644,
    "rows_after": 364
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\work-injuries-for-workers-covered-by-social-insurance-system.csv
{
  "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 644,
    "rows_after": 644
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv
{
  "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv
{
  "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Done. Summary:
[
  {
    "file": "01-sectoral-recruitment.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 80,
      "rows_before": 644,
      "rows_after": 360
    },
    "error": null
  },
  {
    "file": "01-workers-registered-at-civil-service-bureau.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 568,
      "rows_before": 644,
      "rows_after": 924
    },
    "error": null
  },
  {
    "file": "03-area-by-island-2023.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 36,
      "rows_before": 644,
      "rows_after": 392
    },
    "error": null
  },
  {
    "file": "03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 644,
      "rows_after": 452
    },
    "error": null
  },
  {
    "file": "05-health-labour-force-by-sex.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 60,
      "rows_before": 644,
      "rows_after": 416
    },
    "error": null
  },
  {
    "file": "06-number-of-protected-homes.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "number": "count",
      "n": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 10,
      "rows_before": 20,
      "rows_after": 28
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 644,
      "rows_after": 664
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 644,
      "rows_after": 664
    },
    "error": null
  },
  {
    "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "22-deaths-by-age-groups.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 1748,
      "rows_before": 644,
      "rows_after": 2104
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 644,
      "rows_after": 644
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 644,
      "rows_after": 644
    },
    "error": null
  },
  {
    "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-building-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 773,
      "rows_before": 1953,
      "rows_after": 1953
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "change_in_the_number_of_recruitment": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 18
    },
    "error": null
  },
  {
    "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "estimated-workers.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 32,
      "rows_before": 644,
      "rows_after": 356
    },
    "error": null
  },
  {
    "file": "health-services.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 587,
      "rows_before": 1953,
      "rows_after": 1953
    },
    "error": null
  },
  {
    "file": "hotels-and-apartments.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 714,
      "rows_before": 1953,
      "rows_after": 1953
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "governorate": "governorate",
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "job-seekers.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 22
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 28,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "number-of-job-seekers-by-highest-education-level.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 12,
      "rows_before": 20,
      "rows_after": 20
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-governorate-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "value-of-welfare-payments.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 99,
      "rows_before": 644,
      "rows_after": 364
    },
    "error": null
  },
  {
    "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 644,
      "rows_after": 644
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  }
]
[2025-11-29 09:20:47] Starting ingest: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\venv\Scripts\python.exe C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py --run --dry
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
[ingest] Loaded schema overrides from C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\config\schemas.json
[ingest] Running ingest (dry=True) - incoming dir: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-sectoral-recruitment.csv
{
  "file": "01-sectoral-recruitment.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 80,
    "rows_before": 644,
    "rows_after": 360
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-workers-registered-at-civil-service-bureau.csv
{
  "file": "01-workers-registered-at-civil-service-bureau.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 568,
    "rows_before": 644,
    "rows_after": 924
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-area-by-island-2023.csv
{
  "file": "03-area-by-island-2023.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 36,
    "rows_before": 644,
    "rows_after": 392
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-expenditure-per-visitor.csv
{
  "file": "03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 644,
    "rows_after": 452
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\05-health-labour-force-by-sex.csv
{
  "file": "05-health-labour-force-by-sex.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 60,
    "rows_before": 644,
    "rows_after": 416
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\06-number-of-protected-homes.csv
{
  "file": "06-number-of-protected-homes.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "number": "count",
    "n": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 10,
    "rows_before": 20,
    "rows_after": 28
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value (1).csv
{
  "file": "09-annually-compensation-of-employees-cp-value (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 644,
    "rows_after": 664
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value.csv
{
  "file": "09-annually-compensation-of-employees-cp-value.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 644,
    "rows_after": 664
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\22-deaths-by-age-groups.csv
{
  "file": "22-deaths-by-age-groups.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 1748,
    "rows_before": 644,
    "rows_after": 2104
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system (1).csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 644,
    "rows_after": 644
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system.csvC:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)

{
  "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 644,
    "rows_after": 644
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-current-usage-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-ownership-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings.csv
{
  "file": "buildings.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 773,
    "rows_before": 1953,
    "rows_after": 1953
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment.csv
{
  "file": "change-in-the-number-of-recruitment.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "change_in_the_number_of_recruitment": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 18
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-households-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-of-average-households-by-governorate-and-nationality-of-households-.csv
{
  "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-population-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\estimated-workers.csv
{
  "file": "estimated-workers.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 32,
    "rows_before": 644,
    "rows_after": 356
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\health-services.csv
{
  "file": "health-services.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 587,
    "rows_before": 1953,
    "rows_after": 1953
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\hotels-and-apartments.csv
{
  "file": "hotels-and-apartments.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 714,
    "rows_before": 1953,
    "rows_after": 1953
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-governorate-census-2020.csv
{
  "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "governorate": "governorate",
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-occupancy-census-2020 (2).csv
{
  "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\job-seekers.csv
{
  "file": "job-seekers.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 22
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate.csv
{
  "file": "lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv
{
  "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 28,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\number-of-job-seekers-by-highest-education-level.csv
{
  "file": "number-of-job-seekers-by-highest-education-level.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 12,
    "rows_before": 20,
    "rows_after": 20
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv
{
  "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-governorate-and-household-nationality-census-2020.csv
{
  "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-governorate-census-2020.csv
{
  "file": "private-households-by-household-size-and-governorate-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-housing-type-census-2020.csv
{
  "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020 (1).csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020.csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\value-of-welfare-payments.csv
{
  "file": "value-of-welfare-payments.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 99,
    "rows_before": 644,
    "rows_after": 364
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\work-injuries-for-workers-covered-by-social-insurance-system.csv
{
  "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 644,
    "rows_after": 644
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv
{
  "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv
{
  "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Done. Summary:
[
  {
    "file": "01-sectoral-recruitment.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 80,
      "rows_before": 644,
      "rows_after": 360
    },
    "error": null
  },
  {
    "file": "01-workers-registered-at-civil-service-bureau.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 568,
      "rows_before": 644,
      "rows_after": 924
    },
    "error": null
  },
  {
    "file": "03-area-by-island-2023.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 36,
      "rows_before": 644,
      "rows_after": 392
    },
    "error": null
  },
  {
    "file": "03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 644,
      "rows_after": 452
    },
    "error": null
  },
  {
    "file": "05-health-labour-force-by-sex.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 60,
      "rows_before": 644,
      "rows_after": 416
    },
    "error": null
  },
  {
    "file": "06-number-of-protected-homes.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "number": "count",
      "n": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 10,
      "rows_before": 20,
      "rows_after": 28
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 644,
      "rows_after": 664
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 644,
      "rows_after": 664
    },
    "error": null
  },
  {
    "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "22-deaths-by-age-groups.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 1748,
      "rows_before": 644,
      "rows_after": 2104
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 644,
      "rows_after": 644
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 644,
      "rows_after": 644
    },
    "error": null
  },
  {
    "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-building-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 773,
      "rows_before": 1953,
      "rows_after": 1953
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "change_in_the_number_of_recruitment": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 18
    },
    "error": null
  },
  {
    "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "estimated-workers.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 32,
      "rows_before": 644,
      "rows_after": 356
    },
    "error": null
  },
  {
    "file": "health-services.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 587,
      "rows_before": 1953,
      "rows_after": 1953
    },
    "error": null
  },
  {
    "file": "hotels-and-apartments.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 714,
      "rows_before": 1953,
      "rows_after": 1953
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "governorate": "governorate",
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "job-seekers.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 22
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 28,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "number-of-job-seekers-by-highest-education-level.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 12,
      "rows_before": 20,
      "rows_after": 20
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-governorate-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "value-of-welfare-payments.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 99,
      "rows_before": 644,
      "rows_after": 364
    },
    "error": null
  },
  {
    "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 644,
      "rows_after": 644
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  }
]

[2025-11-29 10:05:02] RUN: 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\venv\Scripts\python.exe' 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py' --run --dry
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
[ingest] Loaded schema overrides from C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\config\schemas.json
[ingest] Running ingest (dry=True) - incoming dir: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-sectoral-recruitment.csv
{
  "file": "01-sectoral-recruitment.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 80,
    "rows_before": 3410,
    "rows_after": 3126
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-workers-registered-at-civil-service-bureau.csv
{
  "file": "01-workers-registered-at-civil-service-bureau.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 568,
    "rows_before": 3410,
    "rows_after": 3690
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-area-by-island-2023.csv
{
  "file": "03-area-by-island-2023.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 36,
    "rows_before": 3410,
    "rows_after": 3158
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-expenditure-per-visitor.csv
{
  "file": "03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 3410,
    "rows_after": 3218
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\05-health-labour-force-by-sex.csv
{
  "file": "05-health-labour-force-by-sex.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 60,
    "rows_before": 3410,
    "rows_after": 3182
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\06-number-of-protected-homes.csv
{
  "file": "06-number-of-protected-homes.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "number": "count",
    "n": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 10,
    "rows_before": 20,
    "rows_after": 28
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value (1).csv
{
  "file": "09-annually-compensation-of-employees-cp-value (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3410,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value.csv
{
  "file": "09-annually-compensation-of-employees-cp-value.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3410,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T100502_c403f8_places-of-interest0.csv
{
  "file": "20251129T100502_c403f8_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 1953,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\22-deaths-by-age-groups.csv
{
  "file": "22-deaths-by-age-groups.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 1748,
    "rows_before": 3410,
    "rows_after": 4870
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system (1).csvC:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)

{
  "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system.csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-current-usage-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-ownership-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings.csv
{
  "file": "buildings.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 773,
    "rows_before": 1953,
    "rows_after": 1953
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment.csv
{
  "file": "change-in-the-number-of-recruitment.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "change_in_the_number_of_recruitment": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 18
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-households-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-of-average-households-by-governorate-and-nationality-of-households-.csv
{
  "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-population-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\estimated-workers.csv
{
  "file": "estimated-workers.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 32,
    "rows_before": 3410,
    "rows_after": 3122
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\health-services.csv
{
  "file": "health-services.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 587,
    "rows_before": 1953,
    "rows_after": 1953
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\hotels-and-apartments.csv
{
  "file": "hotels-and-apartments.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 714,
    "rows_before": 1953,
    "rows_after": 1953
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-governorate-census-2020.csv
{
  "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "governorate": "governorate",
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-occupancy-census-2020 (2).csv
{
  "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\job-seekers.csv
{
  "file": "job-seekers.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 22
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate.csv
{
  "file": "lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv
{
  "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 28,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\number-of-job-seekers-by-highest-education-level.csv
{
  "file": "number-of-job-seekers-by-highest-education-level.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 12,
    "rows_before": 20,
    "rows_after": 20
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv
{
  "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-governorate-and-household-nationality-census-2020.csv
{
  "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-governorate-census-2020.csv
{
  "file": "private-households-by-household-size-and-governorate-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-housing-type-census-2020.csv
{
  "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020 (1).csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020.csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\value-of-welfare-payments.csv
{
  "file": "value-of-welfare-payments.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 99,
    "rows_before": 3410,
    "rows_after": 3130
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\work-injuries-for-workers-covered-by-social-insurance-system.csv
{
  "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv
{
  "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv
{
  "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Done. Summary:
[
  {
    "file": "01-sectoral-recruitment.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 80,
      "rows_before": 3410,
      "rows_after": 3126
    },
    "error": null
  },
  {
    "file": "01-workers-registered-at-civil-service-bureau.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 568,
      "rows_before": 3410,
      "rows_after": 3690
    },
    "error": null
  },
  {
    "file": "03-area-by-island-2023.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 36,
      "rows_before": 3410,
      "rows_after": 3158
    },
    "error": null
  },
  {
    "file": "03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 3410,
      "rows_after": 3218
    },
    "error": null
  },
  {
    "file": "05-health-labour-force-by-sex.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 60,
      "rows_before": 3410,
      "rows_after": 3182
    },
    "error": null
  },
  {
    "file": "06-number-of-protected-homes.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "number": "count",
      "n": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 10,
      "rows_before": 20,
      "rows_after": 28
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3410,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3410,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T100502_c403f8_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 1953,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "22-deaths-by-age-groups.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 1748,
      "rows_before": 3410,
      "rows_after": 4870
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-building-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 773,
      "rows_before": 1953,
      "rows_after": 1953
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "change_in_the_number_of_recruitment": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 18
    },
    "error": null
  },
  {
    "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "estimated-workers.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 32,
      "rows_before": 3410,
      "rows_after": 3122
    },
    "error": null
  },
  {
    "file": "health-services.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 587,
      "rows_before": 1953,
      "rows_after": 1953
    },
    "error": null
  },
  {
    "file": "hotels-and-apartments.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 714,
      "rows_before": 1953,
      "rows_after": 1953
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "governorate": "governorate",
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "job-seekers.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 22
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 28,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "number-of-job-seekers-by-highest-education-level.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 12,
      "rows_before": 20,
      "rows_after": 20
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-governorate-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "value-of-welfare-payments.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 99,
      "rows_before": 3410,
      "rows_after": 3130
    },
    "error": null
  },
  {
    "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  }
]


[2025-11-29 10:05:03] RUN: 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\venv\Scripts\python.exe' 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py' --run
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
[ingest] Loaded schema overrides from C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\config\schemas.json
[ingest] Running ingest (dry=False) - incoming dir: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-sectoral-recruitment.csv
{
  "file": "01-sectoral-recruitment.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 80,
    "rows_before": 3410,
    "rows_after": 3126
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-workers-registered-at-civil-service-bureau.csv
{
  "file": "01-workers-registered-at-civil-service-bureau.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 568,
    "rows_before": 3126,
    "rows_after": 3690
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-area-by-island-2023.csv
{
  "file": "03-area-by-island-2023.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 36,
    "rows_before": 3690,
    "rows_after": 3158
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-expenditure-per-visitor.csv
{
  "file": "03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 3158,
    "rows_after": 3218
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\05-health-labour-force-by-sex.csv
{
  "file": "05-health-labour-force-by-sex.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 60,
    "rows_before": 3218,
    "rows_after": 3182
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\06-number-of-protected-homes.csv
{
  "file": "06-number-of-protected-homes.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "number": "count",
    "n": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 10,
    "rows_before": 20,
    "rows_after": 28
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value (1).csv
{
  "file": "09-annually-compensation-of-employees-cp-value (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3182,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value.csv
{
  "file": "09-annually-compensation-of-employees-cp-value.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3430,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T100502_c403f8_places-of-interest0.csv
{
  "file": "20251129T100502_c403f8_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 1953,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\22-deaths-by-age-groups.csv
{
  "file": "22-deaths-by-age-groups.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 1748,
    "rows_before": 3430,
    "rows_after": 4870
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system (1).csvC:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",

{
  "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 4870,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system.csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-current-usage-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-ownership-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings.csv
{
  "file": "buildings.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 773,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment.csv
{
  "file": "change-in-the-number-of-recruitment.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "change_in_the_number_of_recruitment": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 28,
    "rows_after": 18
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-households-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-of-average-households-by-governorate-and-nationality-of-households-.csv
{
  "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-population-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\estimated-workers.csv
{
  "file": "estimated-workers.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 32,
    "rows_before": 3410,
    "rows_after": 3122
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\health-services.csv
{
  "file": "health-services.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 587,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\hotels-and-apartments.csv
{
  "file": "hotels-and-apartments.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 714,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-governorate-census-2020.csv
{
  "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "governorate": "governorate",
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-occupancy-census-2020 (2).csv
{
  "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\job-seekers.csv
{
  "file": "job-seekers.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 18,
    "rows_after": 22
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate.csv
{
  "file": "lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv
{
  "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 28,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",

[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\number-of-job-seekers-by-highest-education-level.csv
{
  "file": "number-of-job-seekers-by-highest-education-level.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 12,
    "rows_before": 22,
    "rows_after": 20
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv
{
  "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-governorate-and-household-nationality-census-2020.csv
{
  "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-governorate-census-2020.csv
{
  "file": "private-households-by-household-size-and-governorate-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-housing-type-census-2020.csv
{
  "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020 (1).csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020.csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\value-of-welfare-payments.csv
{
  "file": "value-of-welfare-payments.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 99,
    "rows_before": 3122,
    "rows_after": 3130
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\work-injuries-for-workers-covered-by-social-insurance-system.csv
{
  "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3130,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv
{
  "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv
{
  "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Done. Summary:
[
  {
    "file": "01-sectoral-recruitment.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 80,
      "rows_before": 3410,
      "rows_after": 3126
    },
    "error": null
  },
  {
    "file": "01-workers-registered-at-civil-service-bureau.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 568,
      "rows_before": 3126,
      "rows_after": 3690
    },
    "error": null
  },
  {
    "file": "03-area-by-island-2023.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 36,
      "rows_before": 3690,
      "rows_after": 3158
    },
    "error": null
  },
  {
    "file": "03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 3158,
      "rows_after": 3218
    },
    "error": null
  },
  {
    "file": "05-health-labour-force-by-sex.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 60,
      "rows_before": 3218,
      "rows_after": 3182
    },
    "error": null
  },
  {
    "file": "06-number-of-protected-homes.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "number": "count",
      "n": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 10,
      "rows_before": 20,
      "rows_after": 28
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3182,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3430,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T100502_c403f8_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 1953,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "22-deaths-by-age-groups.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 1748,
      "rows_before": 3430,
      "rows_after": 4870
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 4870,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-building-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 773,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "change_in_the_number_of_recruitment": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 28,
      "rows_after": 18
    },
    "error": null
  },
  {
    "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "estimated-workers.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 32,
      "rows_before": 3410,
      "rows_after": 3122
    },
    "error": null
  },
  {
    "file": "health-services.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 587,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "hotels-and-apartments.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 714,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "governorate": "governorate",
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "job-seekers.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 18,
      "rows_after": 22
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 28,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "number-of-job-seekers-by-highest-education-level.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 12,
      "rows_before": 22,
      "rows_after": 20
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-governorate-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "value-of-welfare-payments.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 99,
      "rows_before": 3122,
      "rows_after": 3130
    },
    "error": null
  },
  {
    "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3130,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  }
]

[2025-11-29 10:05:04] Ingest sequence finished

[2025-11-29 11:02:08] RUN: 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\venv\Scripts\python.exe' 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py' --run --dry

[2025-11-29 11:02:08] RUN: 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\venv\Scripts\python.exe' 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py' --run --dry
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
[ingest] Loaded schema overrides from C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\config\schemas.json
[ingest] Running ingest (dry=True) - incoming dir: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-sectoral-recruitment.csv
{
  "file": "01-sectoral-recruitment.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 80,
    "rows_before": 3410,
    "rows_after": 3126
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-workers-registered-at-civil-service-bureau.csv
{
  "file": "01-workers-registered-at-civil-service-bureau.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 568,
    "rows_before": 3410,
    "rows_after": 3690
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-area-by-island-2023.csv
{
  "file": "03-area-by-island-2023.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 36,
    "rows_before": 3410,
    "rows_after": 3158
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-expenditure-per-visitor.csv
{
  "file": "03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 3410,
    "rows_after": 3218
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\05-health-labour-force-by-sex.csv
{
  "file": "05-health-labour-force-by-sex.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 60,
    "rows_before": 3410,
    "rows_after": 3182
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\06-number-of-protected-homes.csv
{
  "file": "06-number-of-protected-homes.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "number": "count",
    "n": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 10,
    "rows_before": 20,
    "rows_after": 28
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value (1).csv
{
  "file": "09-annually-compensation-of-employees-cp-value (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3410,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value.csv
{
  "file": "09-annually-compensation-of-employees-cp-value.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3410,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T100502_c403f8_places-of-interest0.csv
{
  "file": "20251129T100502_c403f8_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\22-deaths-by-age-groups.csvC:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)

{
  "file": "22-deaths-by-age-groups.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 1748,
    "rows_before": 3410,
    "rows_after": 4870
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system (1).csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system.csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-current-usage-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-ownership-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings.csv
{
  "file": "buildings.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 773,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment.csv
{
  "file": "change-in-the-number-of-recruitment.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "change_in_the_number_of_recruitment": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 18
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-households-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-of-average-households-by-governorate-and-nationality-of-households-.csv
{
  "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-population-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\estimated-workers.csv
{
  "file": "estimated-workers.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 32,
    "rows_before": 3410,
    "rows_after": 3122
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\health-services.csv
{
  "file": "health-services.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 587,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\hotels-and-apartments.csv
{
  "file": "hotels-and-apartments.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 714,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-governorate-census-2020.csv
{
  "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "governorate": "governorate",
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-occupancy-census-2020 (2).csv
{
  "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\job-seekers.csv
{
  "file": "job-seekers.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 22
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate.csv
{
  "file": "lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv
{
  "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 28,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\number-of-job-seekers-by-highest-education-level.csv
{
  "file": "number-of-job-seekers-by-highest-education-level.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 12,
    "rows_before": 20,
    "rows_after": 20
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv
{
  "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-governorate-and-household-nationality-census-2020.csv
{
  "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-governorate-census-2020.csv
{
  "file": "private-households-by-household-size-and-governorate-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-housing-type-census-2020.csv
{
  "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020 (1).csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020.csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\value-of-welfare-payments.csv
{
  "file": "value-of-welfare-payments.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 99,
    "rows_before": 3410,
    "rows_after": 3130
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\work-injuries-for-workers-covered-by-social-insurance-system.csv
{
  "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv
{
  "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv
{
  "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Done. Summary:
[
  {
    "file": "01-sectoral-recruitment.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 80,
      "rows_before": 3410,
      "rows_after": 3126
    },
    "error": null
  },
  {
    "file": "01-workers-registered-at-civil-service-bureau.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 568,
      "rows_before": 3410,
      "rows_after": 3690
    },
    "error": null
  },
  {
    "file": "03-area-by-island-2023.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 36,
      "rows_before": 3410,
      "rows_after": 3158
    },
    "error": null
  },
  {
    "file": "03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 3410,
      "rows_after": 3218
    },
    "error": null
  },
  {
    "file": "05-health-labour-force-by-sex.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 60,
      "rows_before": 3410,
      "rows_after": 3182
    },
    "error": null
  },
  {
    "file": "06-number-of-protected-homes.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "number": "count",
      "n": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 10,
      "rows_before": 20,
      "rows_after": 28
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3410,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3410,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T100502_c403f8_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "22-deaths-by-age-groups.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 1748,
      "rows_before": 3410,
      "rows_after": 4870
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-building-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 773,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "change_in_the_number_of_recruitment": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 18
    },
    "error": null
  },
  {
    "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "estimated-workers.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 32,
      "rows_before": 3410,
      "rows_after": 3122
    },
    "error": null
  },
  {
    "file": "health-services.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 587,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "hotels-and-apartments.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 714,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "governorate": "governorate",
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "job-seekers.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 22
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 28,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "number-of-job-seekers-by-highest-education-level.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 12,
      "rows_before": 20,
      "rows_after": 20
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-governorate-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "value-of-welfare-payments.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 99,
      "rows_before": 3410,
      "rows_after": 3130
    },
    "error": null
  },
  {
    "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  }
]


[2025-11-29 11:02:10] RUN: 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\venv\Scripts\python.exe' 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py' --run
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
[ingest] Loaded schema overrides from C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\config\schemas.json
[ingest] Running ingest (dry=True) - incoming dir: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-sectoral-recruitment.csv
{
  "file": "01-sectoral-recruitment.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 80,
    "rows_before": 3410,
    "rows_after": 3126
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-workers-registered-at-civil-service-bureau.csv
{
  "file": "01-workers-registered-at-civil-service-bureau.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 568,
    "rows_before": 3410,
    "rows_after": 3690
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-area-by-island-2023.csv
{
  "file": "03-area-by-island-2023.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 36,
    "rows_before": 3410,
    "rows_after": 3158
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-expenditure-per-visitor.csv
{
  "file": "03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 3410,
    "rows_after": 3218
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\05-health-labour-force-by-sex.csv
{
  "file": "05-health-labour-force-by-sex.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 60,
    "rows_before": 3410,
    "rows_after": 3182
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\06-number-of-protected-homes.csv
{
  "file": "06-number-of-protected-homes.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "number": "count",
    "n": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 10,
    "rows_before": 20,
    "rows_after": 28
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value (1).csv
{
  "file": "09-annually-compensation-of-employees-cp-value (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3410,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value.csv
{
  "file": "09-annually-compensation-of-employees-cp-value.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3410,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T100502_c403f8_places-of-interest0.csv
{
  "file": "20251129T100502_c403f8_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\22-deaths-by-age-groups.csvC:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)

{
  "file": "22-deaths-by-age-groups.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 1748,
    "rows_before": 3410,
    "rows_after": 4870
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system (1).csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system.csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-current-usage-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-ownership-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings.csv
{
  "file": "buildings.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 773,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment.csv
{
  "file": "change-in-the-number-of-recruitment.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "change_in_the_number_of_recruitment": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 18
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-households-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-of-average-households-by-governorate-and-nationality-of-households-.csv
{
  "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-population-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\estimated-workers.csv
{
  "file": "estimated-workers.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 32,
    "rows_before": 3410,
    "rows_after": 3122
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\health-services.csv
{
  "file": "health-services.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 587,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\hotels-and-apartments.csv
{
  "file": "hotels-and-apartments.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 714,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-governorate-census-2020.csv
{
  "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "governorate": "governorate",
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-occupancy-census-2020 (2).csv
{
  "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\job-seekers.csv
{
  "file": "job-seekers.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 22
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate.csv
{
  "file": "lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv
{
  "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 28,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\number-of-job-seekers-by-highest-education-level.csv
{
  "file": "number-of-job-seekers-by-highest-education-level.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 12,
    "rows_before": 20,
    "rows_after": 20
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv
{
  "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-governorate-and-household-nationality-census-2020.csv
{
  "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-governorate-census-2020.csv
{
  "file": "private-households-by-household-size-and-governorate-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-housing-type-census-2020.csv
{
  "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020 (1).csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020.csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\value-of-welfare-payments.csv
{
  "file": "value-of-welfare-payments.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 99,
    "rows_before": 3410,
    "rows_after": 3130
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\work-injuries-for-workers-covered-by-social-insurance-system.csv
{
  "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv
{
  "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv
{
  "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Done. Summary:
[
  {
    "file": "01-sectoral-recruitment.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 80,
      "rows_before": 3410,
      "rows_after": 3126
    },
    "error": null
  },
  {
    "file": "01-workers-registered-at-civil-service-bureau.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 568,
      "rows_before": 3410,
      "rows_after": 3690
    },
    "error": null
  },
  {
    "file": "03-area-by-island-2023.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 36,
      "rows_before": 3410,
      "rows_after": 3158
    },
    "error": null
  },
  {
    "file": "03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 3410,
      "rows_after": 3218
    },
    "error": null
  },
  {
    "file": "05-health-labour-force-by-sex.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 60,
      "rows_before": 3410,
      "rows_after": 3182
    },
    "error": null
  },
  {
    "file": "06-number-of-protected-homes.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "number": "count",
      "n": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 10,
      "rows_before": 20,
      "rows_after": 28
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3410,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3410,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T100502_c403f8_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "22-deaths-by-age-groups.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 1748,
      "rows_before": 3410,
      "rows_after": 4870
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-building-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 773,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "change_in_the_number_of_recruitment": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 18
    },
    "error": null
  },
  {
    "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "estimated-workers.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 32,
      "rows_before": 3410,
      "rows_after": 3122
    },
    "error": null
  },
  {
    "file": "health-services.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 587,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "hotels-and-apartments.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 714,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "governorate": "governorate",
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "job-seekers.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 22
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 28,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "number-of-job-seekers-by-highest-education-level.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 12,
      "rows_before": 20,
      "rows_after": 20
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-governorate-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "value-of-welfare-payments.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 99,
      "rows_before": 3410,
      "rows_after": 3130
    },
    "error": null
  },
  {
    "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  }
]


[2025-11-29 11:02:10] RUN: 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\venv\Scripts\python.exe' 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py' --run
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
[ingest] Loaded schema overrides from C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\config\schemas.json
[ingest] Running ingest (dry=False) - incoming dir: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-sectoral-recruitment.csv
{
  "file": "01-sectoral-recruitment.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 80,
    "rows_before": 3410,
    "rows_after": 3126
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-workers-registered-at-civil-service-bureau.csv
{
  "file": "01-workers-registered-at-civil-service-bureau.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 568,
    "rows_before": 3126,
    "rows_after": 3690
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-area-by-island-2023.csv
{
  "file": "03-area-by-island-2023.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 36,
    "rows_before": 3690,
    "rows_after": 3158
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-expenditure-per-visitor.csv
{
  "file": "03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 3158,
    "rows_after": 3218
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\05-health-labour-force-by-sex.csv
{
  "file": "05-health-labour-force-by-sex.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 60,
    "rows_before": 3218,
    "rows_after": 3182
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\06-number-of-protected-homes.csv
{
  "file": "06-number-of-protected-homes.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "number": "count",
    "n": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 10,
    "rows_before": 20,
    "rows_after": 28
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value (1).csv
{
  "file": "09-annually-compensation-of-employees-cp-value (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3690,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value.csv
{
  "file": "09-annually-compensation-of-employees-cp-value.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3158,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T100502_c403f8_places-of-interest0.csv
{
  "file": "20251129T100502_c403f8_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\22-deaths-by-age-groups.csvC:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",

{
  "file": "22-deaths-by-age-groups.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 1748,
    "rows_before": 3430,
    "rows_after": 4870
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system (1).csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 4870,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system.csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-current-usage-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-ownership-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings.csv
{
  "file": "buildings.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 773,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment.csv
{
  "file": "change-in-the-number-of-recruitment.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "change_in_the_number_of_recruitment": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 28,
    "rows_after": 18
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-households-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-of-average-households-by-governorate-and-nationality-of-households-.csv
{
  "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-population-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\estimated-workers.csv
{
  "file": "estimated-workers.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 32,
    "rows_before": 3410,
    "rows_after": 3122
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\health-services.csv
{
  "file": "health-services.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 587,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\hotels-and-apartments.csv
{
  "file": "hotels-and-apartments.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 714,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-governorate-census-2020.csv
{
  "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "governorate": "governorate",
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-occupancy-census-2020 (2).csv
{
  "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\job-seekers.csv
{
  "file": "job-seekers.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 18,
    "rows_after": 22
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate.csv
{
  "file": "lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",

[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv
{
  "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 28,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\number-of-job-seekers-by-highest-education-level.csv
{
  "file": "number-of-job-seekers-by-highest-education-level.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 12,
    "rows_before": 22,
    "rows_after": 20
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv
{
  "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-governorate-and-household-nationality-census-2020.csv
{
  "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-governorate-census-2020.csv
{
  "file": "private-households-by-household-size-and-governorate-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-housing-type-census-2020.csv
{
  "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020 (1).csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020.csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\value-of-welfare-payments.csv
{
  "file": "value-of-welfare-payments.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 99,
    "rows_before": 3122,
    "rows_after": 3130
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\work-injuries-for-workers-covered-by-social-insurance-system.csv
{
  "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3130,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv
{
  "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv
{
  "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Done. Summary:
[
  {
    "file": "01-sectoral-recruitment.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 80,
      "rows_before": 3410,
      "rows_after": 3126
    },
    "error": null
  },
  {
    "file": "01-workers-registered-at-civil-service-bureau.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 568,
      "rows_before": 3126,
      "rows_after": 3690
    },
    "error": null
  },
  {
    "file": "03-area-by-island-2023.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 36,
      "rows_before": 3690,
      "rows_after": 3158
    },
    "error": null
  },
  {
    "file": "03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 3158,
      "rows_after": 3218
    },
    "error": null
  },
  {
    "file": "05-health-labour-force-by-sex.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 60,
      "rows_before": 3218,
      "rows_after": 3182
    },
    "error": null
  },
  {
    "file": "06-number-of-protected-homes.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "number": "count",
      "n": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 10,
      "rows_before": 20,
      "rows_after": 28
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3690,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3158,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T100502_c403f8_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "22-deaths-by-age-groups.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 1748,
      "rows_before": 3430,
      "rows_after": 4870
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 4870,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-building-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 773,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "change_in_the_number_of_recruitment": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 28,
      "rows_after": 18
    },
    "error": null
  },
  {
    "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "estimated-workers.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 32,
      "rows_before": 3410,
      "rows_after": 3122
    },
    "error": null
  },
  {
    "file": "health-services.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 587,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "hotels-and-apartments.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 714,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "governorate": "governorate",
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "job-seekers.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 18,
      "rows_after": 22
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 28,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "number-of-job-seekers-by-highest-education-level.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 12,
      "rows_before": 22,
      "rows_after": 20
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-governorate-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "value-of-welfare-payments.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 99,
      "rows_before": 3122,
      "rows_after": 3130
    },
    "error": null
  },
  {
    "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3130,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  }
]

[2025-11-29 11:02:11] Ingest sequence finished
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
[ingest] Loaded schema overrides from C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\config\schemas.json
[ingest] Running ingest (dry=False) - incoming dir: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-sectoral-recruitment.csv
{
  "file": "01-sectoral-recruitment.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 80,
    "rows_before": 3218,
    "rows_after": 3126
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-workers-registered-at-civil-service-bureau.csv
{
  "file": "01-workers-registered-at-civil-service-bureau.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 568,
    "rows_before": 3182,
    "rows_after": 3690
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-area-by-island-2023.csv
{
  "file": "03-area-by-island-2023.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 36,
    "rows_before": 3690,
    "rows_after": 3158
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-expenditure-per-visitor.csv
{
  "file": "03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 3158,
    "rows_after": 3218
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\05-health-labour-force-by-sex.csv
{
  "file": "05-health-labour-force-by-sex.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 60,
    "rows_before": 3218,
    "rows_after": 3182
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\06-number-of-protected-homes.csv
{
  "file": "06-number-of-protected-homes.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "number": "count",
    "n": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 10,
    "rows_before": 28,
    "rows_after": 28
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value (1).csv
{
  "file": "09-annually-compensation-of-employees-cp-value (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3182,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value.csv
{
  "file": "09-annually-compensation-of-employees-cp-value.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3430,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T100502_c403f8_places-of-interest0.csv
{
  "file": "20251129T100502_c403f8_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\22-deaths-by-age-groups.csvC:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",

{
  "file": "22-deaths-by-age-groups.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 1748,
    "rows_before": 3410,
    "rows_after": 4870
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system (1).csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 4870,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system.csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-current-usage-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-ownership-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings.csv
{
  "file": "buildings.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 773,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment.csv
{
  "file": "change-in-the-number-of-recruitment.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "change_in_the_number_of_recruitment": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 18,
    "rows_after": 18
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-households-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-of-average-households-by-governorate-and-nationality-of-households-.csv
{
  "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-population-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\estimated-workers.csv
{
  "file": "estimated-workers.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 32,
    "rows_before": 3122,
    "rows_after": 3122
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\health-services.csv
{
  "file": "health-services.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 587,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\hotels-and-apartments.csv
{
  "file": "hotels-and-apartments.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 714,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-governorate-census-2020.csv
{
  "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "governorate": "governorate",
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-occupancy-census-2020 (2).csv
{
  "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\job-seekers.csv
{
  "file": "job-seekers.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 22
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate.csv
{
  "file": "lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",

[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv
{
  "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 28,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\number-of-job-seekers-by-highest-education-level.csv
{
  "file": "number-of-job-seekers-by-highest-education-level.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 12,
    "rows_before": 22,
    "rows_after": 20
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv
{
  "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-governorate-and-household-nationality-census-2020.csv
{
  "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-governorate-census-2020.csv
{
  "file": "private-households-by-household-size-and-governorate-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-housing-type-census-2020.csv
{
  "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020 (1).csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020.csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\value-of-welfare-payments.csv
{
  "file": "value-of-welfare-payments.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 99,
    "rows_before": 3410,
    "rows_after": 3130
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\work-injuries-for-workers-covered-by-social-insurance-system.csv
{
  "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3130,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv
{
  "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv
{
  "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Done. Summary:
[
  {
    "file": "01-sectoral-recruitment.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 80,
      "rows_before": 3218,
      "rows_after": 3126
    },
    "error": null
  },
  {
    "file": "01-workers-registered-at-civil-service-bureau.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 568,
      "rows_before": 3182,
      "rows_after": 3690
    },
    "error": null
  },
  {
    "file": "03-area-by-island-2023.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 36,
      "rows_before": 3690,
      "rows_after": 3158
    },
    "error": null
  },
  {
    "file": "03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 3158,
      "rows_after": 3218
    },
    "error": null
  },
  {
    "file": "05-health-labour-force-by-sex.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 60,
      "rows_before": 3218,
      "rows_after": 3182
    },
    "error": null
  },
  {
    "file": "06-number-of-protected-homes.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "number": "count",
      "n": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 10,
      "rows_before": 28,
      "rows_after": 28
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3182,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3430,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T100502_c403f8_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "22-deaths-by-age-groups.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 1748,
      "rows_before": 3410,
      "rows_after": 4870
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 4870,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-building-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 773,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "change_in_the_number_of_recruitment": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 18,
      "rows_after": 18
    },
    "error": null
  },
  {
    "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "estimated-workers.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 32,
      "rows_before": 3122,
      "rows_after": 3122
    },
    "error": null
  },
  {
    "file": "health-services.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 587,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "hotels-and-apartments.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 714,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "governorate": "governorate",
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "job-seekers.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 22
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 28,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "number-of-job-seekers-by-highest-education-level.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 12,
      "rows_before": 22,
      "rows_after": 20
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-governorate-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "value-of-welfare-payments.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 99,
      "rows_before": 3410,
      "rows_after": 3130
    },
    "error": null
  },
  {
    "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3130,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  }
]

[2025-11-29 11:02:11] Ingest sequence finished

[2025-11-29 11:19:11] RUN: 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\venv\Scripts\python.exe' 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py' --run --dry
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
[ingest] Loaded schema overrides from C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\config\schemas.json
[ingest] Running ingest (dry=True) - incoming dir: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-sectoral-recruitment.csv
{
  "file": "01-sectoral-recruitment.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 80,
    "rows_before": 3410,
    "rows_after": 3126
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-workers-registered-at-civil-service-bureau.csv
{
  "file": "01-workers-registered-at-civil-service-bureau.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 568,
    "rows_before": 3410,
    "rows_after": 3690
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-area-by-island-2023.csv
{
  "file": "03-area-by-island-2023.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 36,
    "rows_before": 3410,
    "rows_after": 3158
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-expenditure-per-visitor.csv
{
  "file": "03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 3410,
    "rows_after": 3218
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\05-health-labour-force-by-sex.csv
{
  "file": "05-health-labour-force-by-sex.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 60,
    "rows_before": 3410,
    "rows_after": 3182
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\06-number-of-protected-homes.csv
{
  "file": "06-number-of-protected-homes.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "number": "count",
    "n": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 10,
    "rows_before": 20,
    "rows_after": 28
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value (1).csv
{
  "file": "09-annually-compensation-of-employees-cp-value (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3410,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value.csv
{
  "file": "09-annually-compensation-of-employees-cp-value.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3410,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T100502_c403f8_places-of-interest0.csv
{
  "file": "20251129T100502_c403f8_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csvC:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)

{
  "file": "20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\22-deaths-by-age-groups.csv
{
  "file": "22-deaths-by-age-groups.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 1748,
    "rows_before": 3410,
    "rows_after": 4870
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system (1).csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system.csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-current-usage-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-ownership-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings.csv
{
  "file": "buildings.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 773,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment.csv
{
  "file": "change-in-the-number-of-recruitment.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "change_in_the_number_of_recruitment": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 18
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-households-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-of-average-households-by-governorate-and-nationality-of-households-.csv
{
  "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-population-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\estimated-workers.csv
{
  "file": "estimated-workers.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 32,
    "rows_before": 3410,
    "rows_after": 3122
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\health-services.csv
{
  "file": "health-services.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 587,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\hotels-and-apartments.csv
{
  "file": "hotels-and-apartments.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 714,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-governorate-census-2020.csv
{
  "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "governorate": "governorate",
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-occupancy-census-2020 (2).csv
{
  "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\job-seekers.csv
{
  "file": "job-seekers.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 22
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate.csv
{
  "file": "lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv
{
  "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 28,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\number-of-job-seekers-by-highest-education-level.csv
{
  "file": "number-of-job-seekers-by-highest-education-level.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 12,
    "rows_before": 20,
    "rows_after": 20
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv
{
  "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-governorate-and-household-nationality-census-2020.csv
{
  "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-governorate-census-2020.csv
{
  "file": "private-households-by-household-size-and-governorate-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-housing-type-census-2020.csv
{
  "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020 (1).csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020.csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\value-of-welfare-payments.csv
{
  "file": "value-of-welfare-payments.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 99,
    "rows_before": 3410,
    "rows_after": 3130
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\work-injuries-for-workers-covered-by-social-insurance-system.csv
{
  "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv
{
  "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv
{
  "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Done. Summary:
[
  {
    "file": "01-sectoral-recruitment.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 80,
      "rows_before": 3410,
      "rows_after": 3126
    },
    "error": null
  },
  {
    "file": "01-workers-registered-at-civil-service-bureau.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 568,
      "rows_before": 3410,
      "rows_after": 3690
    },
    "error": null
  },
  {
    "file": "03-area-by-island-2023.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 36,
      "rows_before": 3410,
      "rows_after": 3158
    },
    "error": null
  },
  {
    "file": "03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 3410,
      "rows_after": 3218
    },
    "error": null
  },
  {
    "file": "05-health-labour-force-by-sex.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 60,
      "rows_before": 3410,
      "rows_after": 3182
    },
    "error": null
  },
  {
    "file": "06-number-of-protected-homes.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "number": "count",
      "n": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 10,
      "rows_before": 20,
      "rows_after": 28
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3410,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3410,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T100502_c403f8_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "22-deaths-by-age-groups.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 1748,
      "rows_before": 3410,
      "rows_after": 4870
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-building-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 773,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "change_in_the_number_of_recruitment": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 18
    },
    "error": null
  },
  {
    "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "estimated-workers.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 32,
      "rows_before": 3410,
      "rows_after": 3122
    },
    "error": null
  },
  {
    "file": "health-services.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 587,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "hotels-and-apartments.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 714,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "governorate": "governorate",
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "job-seekers.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 22
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 28,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "number-of-job-seekers-by-highest-education-level.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 12,
      "rows_before": 20,
      "rows_after": 20
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-governorate-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "value-of-welfare-payments.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 99,
      "rows_before": 3410,
      "rows_after": 3130
    },
    "error": null
  },
  {
    "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  }
]


[2025-11-29 11:19:12] RUN: 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\venv\Scripts\python.exe' 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py' --run
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
[ingest] Loaded schema overrides from C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\config\schemas.json
[ingest] Running ingest (dry=False) - incoming dir: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-sectoral-recruitment.csv
{
  "file": "01-sectoral-recruitment.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 80,
    "rows_before": 3410,
    "rows_after": 3126
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-workers-registered-at-civil-service-bureau.csv
{
  "file": "01-workers-registered-at-civil-service-bureau.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 568,
    "rows_before": 3126,
    "rows_after": 3690
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-area-by-island-2023.csv
{
  "file": "03-area-by-island-2023.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 36,
    "rows_before": 3690,
    "rows_after": 3158
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-expenditure-per-visitor.csv
{
  "file": "03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 3158,
    "rows_after": 3218
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\05-health-labour-force-by-sex.csv
{
  "file": "05-health-labour-force-by-sex.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 60,
    "rows_before": 3218,
    "rows_after": 3182
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\06-number-of-protected-homes.csv
{
  "file": "06-number-of-protected-homes.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "number": "count",
    "n": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 10,
    "rows_before": 20,
    "rows_after": 28
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value (1).csv
{
  "file": "09-annually-compensation-of-employees-cp-value (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3182,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value.csv
{
  "file": "09-annually-compensation-of-employees-cp-value.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3430,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T100502_c403f8_places-of-interest0.csv
{
  "file": "20251129T100502_c403f8_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csvC:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",

{
  "file": "20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\22-deaths-by-age-groups.csv
{
  "file": "22-deaths-by-age-groups.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 1748,
    "rows_before": 3430,
    "rows_after": 4870
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system (1).csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 4870,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system.csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-current-usage-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-ownership-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings.csv
{
  "file": "buildings.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 773,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment.csv
{
  "file": "change-in-the-number-of-recruitment.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "change_in_the_number_of_recruitment": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 28,
    "rows_after": 18
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-households-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-of-average-households-by-governorate-and-nationality-of-households-.csv
{
  "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-population-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\estimated-workers.csv
{
  "file": "estimated-workers.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 32,
    "rows_before": 3410,
    "rows_after": 3122
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\health-services.csv
{
  "file": "health-services.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 587,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\hotels-and-apartments.csv
{
  "file": "hotels-and-apartments.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 714,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-governorate-census-2020.csv
{
  "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "governorate": "governorate",
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-occupancy-census-2020 (2).csv
{
  "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\job-seekers.csv
{
  "file": "job-seekers.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 18,
    "rows_after": 22
  },
  "error": null
}C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",

[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate.csv
{
  "file": "lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv
{
  "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 28,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\number-of-job-seekers-by-highest-education-level.csv
{
  "file": "number-of-job-seekers-by-highest-education-level.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 12,
    "rows_before": 22,
    "rows_after": 20
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv
{
  "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-governorate-and-household-nationality-census-2020.csv
{
  "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-governorate-census-2020.csv
{
  "file": "private-households-by-household-size-and-governorate-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-housing-type-census-2020.csv
{
  "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020 (1).csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020.csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\value-of-welfare-payments.csv
{
  "file": "value-of-welfare-payments.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 99,
    "rows_before": 3122,
    "rows_after": 3130
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\work-injuries-for-workers-covered-by-social-insurance-system.csv
{
  "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3130,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv
{
  "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv
{
  "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Done. Summary:
[
  {
    "file": "01-sectoral-recruitment.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 80,
      "rows_before": 3410,
      "rows_after": 3126
    },
    "error": null
  },
  {
    "file": "01-workers-registered-at-civil-service-bureau.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 568,
      "rows_before": 3126,
      "rows_after": 3690
    },
    "error": null
  },
  {
    "file": "03-area-by-island-2023.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 36,
      "rows_before": 3690,
      "rows_after": 3158
    },
    "error": null
  },
  {
    "file": "03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 3158,
      "rows_after": 3218
    },
    "error": null
  },
  {
    "file": "05-health-labour-force-by-sex.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 60,
      "rows_before": 3218,
      "rows_after": 3182
    },
    "error": null
  },
  {
    "file": "06-number-of-protected-homes.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "number": "count",
      "n": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 10,
      "rows_before": 20,
      "rows_after": 28
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3182,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3430,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T100502_c403f8_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "22-deaths-by-age-groups.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 1748,
      "rows_before": 3430,
      "rows_after": 4870
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 4870,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-building-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 773,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "change_in_the_number_of_recruitment": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 28,
      "rows_after": 18
    },
    "error": null
  },
  {
    "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "estimated-workers.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 32,
      "rows_before": 3410,
      "rows_after": 3122
    },
    "error": null
  },
  {
    "file": "health-services.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 587,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "hotels-and-apartments.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 714,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "governorate": "governorate",
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "job-seekers.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 18,
      "rows_after": 22
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 28,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "number-of-job-seekers-by-highest-education-level.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 12,
      "rows_before": 22,
      "rows_after": 20
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-governorate-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "value-of-welfare-payments.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 99,
      "rows_before": 3122,
      "rows_after": 3130
    },
    "error": null
  },
  {
    "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3130,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  }
]

[2025-11-29 11:19:13] Ingest sequence finished

[2025-11-29 11:35:23] RUN: 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\venv\Scripts\python.exe' 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py' --run --dry
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
[ingest] Loaded schema overrides from C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\config\schemas.json
[ingest] Running ingest (dry=True) - incoming dir: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-sectoral-recruitment.csv
{
  "file": "01-sectoral-recruitment.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 80,
    "rows_before": 3410,
    "rows_after": 3126
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-workers-registered-at-civil-service-bureau.csv
{
  "file": "01-workers-registered-at-civil-service-bureau.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 568,
    "rows_before": 3410,
    "rows_after": 3690
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-area-by-island-2023.csv
{
  "file": "03-area-by-island-2023.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 36,
    "rows_before": 3410,
    "rows_after": 3158
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-expenditure-per-visitor.csv
{
  "file": "03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 3410,
    "rows_after": 3218
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\05-health-labour-force-by-sex.csv
{
  "file": "05-health-labour-force-by-sex.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 60,
    "rows_before": 3410,
    "rows_after": 3182
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\06-number-of-protected-homes.csv
{
  "file": "06-number-of-protected-homes.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "number": "count",
    "n": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 10,
    "rows_before": 20,
    "rows_after": 28
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value (1).csv
{
  "file": "09-annually-compensation-of-employees-cp-value (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3410,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value.csv
{
  "file": "09-annually-compensation-of-employees-cp-value.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3410,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T100502_c403f8_places-of-interest0.csv
{
  "file": "20251129T100502_c403f8_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csvC:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)

{
  "file": "20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T113523_55e220_places-of-interest0.csv
{
  "file": "20251129T113523_55e220_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\22-deaths-by-age-groups.csv
{
  "file": "22-deaths-by-age-groups.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 1748,
    "rows_before": 3410,
    "rows_after": 4870
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system (1).csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system.csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-current-usage-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-ownership-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings.csv
{
  "file": "buildings.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 773,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment.csv
{
  "file": "change-in-the-number-of-recruitment.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "change_in_the_number_of_recruitment": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 18
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-households-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-of-average-households-by-governorate-and-nationality-of-households-.csv
{
  "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-population-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\estimated-workers.csv
{
  "file": "estimated-workers.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 32,
    "rows_before": 3410,
    "rows_after": 3122
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\health-services.csv
{
  "file": "health-services.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 587,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\hotels-and-apartments.csv
{
  "file": "hotels-and-apartments.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 714,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-governorate-census-2020.csv
{
  "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "governorate": "governorate",
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-occupancy-census-2020 (2).csv
{
  "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\job-seekers.csv
{
  "file": "job-seekers.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 22
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate.csv
{
  "file": "lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv
{
  "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 28,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\number-of-job-seekers-by-highest-education-level.csv
{
  "file": "number-of-job-seekers-by-highest-education-level.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 12,
    "rows_before": 20,
    "rows_after": 20
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv
{
  "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-governorate-and-household-nationality-census-2020.csv
{
  "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-governorate-census-2020.csv
{
  "file": "private-households-by-household-size-and-governorate-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-housing-type-census-2020.csv
{
  "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020 (1).csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020.csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\value-of-welfare-payments.csv
{
  "file": "value-of-welfare-payments.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 99,
    "rows_before": 3410,
    "rows_after": 3130
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\work-injuries-for-workers-covered-by-social-insurance-system.csv
{
  "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv
{
  "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv
{
  "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Done. Summary:
[
  {
    "file": "01-sectoral-recruitment.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 80,
      "rows_before": 3410,
      "rows_after": 3126
    },
    "error": null
  },
  {
    "file": "01-workers-registered-at-civil-service-bureau.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 568,
      "rows_before": 3410,
      "rows_after": 3690
    },
    "error": null
  },
  {
    "file": "03-area-by-island-2023.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 36,
      "rows_before": 3410,
      "rows_after": 3158
    },
    "error": null
  },
  {
    "file": "03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 3410,
      "rows_after": 3218
    },
    "error": null
  },
  {
    "file": "05-health-labour-force-by-sex.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 60,
      "rows_before": 3410,
      "rows_after": 3182
    },
    "error": null
  },
  {
    "file": "06-number-of-protected-homes.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "number": "count",
      "n": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 10,
      "rows_before": 20,
      "rows_after": 28
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3410,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3410,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T100502_c403f8_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T113523_55e220_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "22-deaths-by-age-groups.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 1748,
      "rows_before": 3410,
      "rows_after": 4870
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-building-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 773,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "change_in_the_number_of_recruitment": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 18
    },
    "error": null
  },
  {
    "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "estimated-workers.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 32,
      "rows_before": 3410,
      "rows_after": 3122
    },
    "error": null
  },
  {
    "file": "health-services.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 587,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "hotels-and-apartments.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 714,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "governorate": "governorate",
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "job-seekers.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 22
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 28,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "number-of-job-seekers-by-highest-education-level.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 12,
      "rows_before": 20,
      "rows_after": 20
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-governorate-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "value-of-welfare-payments.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 99,
      "rows_before": 3410,
      "rows_after": 3130
    },
    "error": null
  },
  {
    "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  }
]


[2025-11-29 11:35:24] RUN: 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\venv\Scripts\python.exe' 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py' --run
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
[ingest] Loaded schema overrides from C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\config\schemas.json
[ingest] Running ingest (dry=False) - incoming dir: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-sectoral-recruitment.csv
{
  "file": "01-sectoral-recruitment.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 80,
    "rows_before": 3410,
    "rows_after": 3126
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-workers-registered-at-civil-service-bureau.csv
{
  "file": "01-workers-registered-at-civil-service-bureau.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 568,
    "rows_before": 3126,
    "rows_after": 3690
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-area-by-island-2023.csv
{
  "file": "03-area-by-island-2023.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 36,
    "rows_before": 3690,
    "rows_after": 3158
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-expenditure-per-visitor.csv
{
  "file": "03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 3158,
    "rows_after": 3218
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\05-health-labour-force-by-sex.csv
{
  "file": "05-health-labour-force-by-sex.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 60,
    "rows_before": 3218,
    "rows_after": 3182
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\06-number-of-protected-homes.csv
{
  "file": "06-number-of-protected-homes.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "number": "count",
    "n": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 10,
    "rows_before": 20,
    "rows_after": 28
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value (1).csv
{
  "file": "09-annually-compensation-of-employees-cp-value (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3182,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value.csv
{
  "file": "09-annually-compensation-of-employees-cp-value.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3430,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T100502_c403f8_places-of-interest0.csv
{
  "file": "20251129T100502_c403f8_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csvC:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",

{
  "file": "20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T113523_55e220_places-of-interest0.csv
{
  "file": "20251129T113523_55e220_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\22-deaths-by-age-groups.csv
{
  "file": "22-deaths-by-age-groups.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 1748,
    "rows_before": 3430,
    "rows_after": 4870
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system (1).csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 4870,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system.csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-current-usage-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-ownership-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings.csv
{
  "file": "buildings.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 773,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment.csv
{
  "file": "change-in-the-number-of-recruitment.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "change_in_the_number_of_recruitment": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 28,
    "rows_after": 18
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-households-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-of-average-households-by-governorate-and-nationality-of-households-.csv
{
  "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-population-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\estimated-workers.csv
{
  "file": "estimated-workers.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 32,
    "rows_before": 3410,
    "rows_after": 3122
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\health-services.csv
{
  "file": "health-services.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 587,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\hotels-and-apartments.csv
{
  "file": "hotels-and-apartments.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 714,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-governorate-census-2020.csv
{
  "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "governorate": "governorate",
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-occupancy-census-2020 (2).csv
{
  "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",

[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\job-seekers.csv
{
  "file": "job-seekers.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 18,
    "rows_after": 22
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate.csv
{
  "file": "lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv
{
  "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 28,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\number-of-job-seekers-by-highest-education-level.csv
{
  "file": "number-of-job-seekers-by-highest-education-level.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 12,
    "rows_before": 22,
    "rows_after": 20
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv
{
  "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-governorate-and-household-nationality-census-2020.csv
{
  "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-governorate-census-2020.csv
{
  "file": "private-households-by-household-size-and-governorate-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-housing-type-census-2020.csv
{
  "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020 (1).csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020.csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\value-of-welfare-payments.csv
{
  "file": "value-of-welfare-payments.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 99,
    "rows_before": 3122,
    "rows_after": 3130
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\work-injuries-for-workers-covered-by-social-insurance-system.csv
{
  "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3130,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv
{
  "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv
{
  "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Done. Summary:
[
  {
    "file": "01-sectoral-recruitment.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 80,
      "rows_before": 3410,
      "rows_after": 3126
    },
    "error": null
  },
  {
    "file": "01-workers-registered-at-civil-service-bureau.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 568,
      "rows_before": 3126,
      "rows_after": 3690
    },
    "error": null
  },
  {
    "file": "03-area-by-island-2023.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 36,
      "rows_before": 3690,
      "rows_after": 3158
    },
    "error": null
  },
  {
    "file": "03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 3158,
      "rows_after": 3218
    },
    "error": null
  },
  {
    "file": "05-health-labour-force-by-sex.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 60,
      "rows_before": 3218,
      "rows_after": 3182
    },
    "error": null
  },
  {
    "file": "06-number-of-protected-homes.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "number": "count",
      "n": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 10,
      "rows_before": 20,
      "rows_after": 28
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3182,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3430,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T100502_c403f8_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T113523_55e220_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "22-deaths-by-age-groups.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 1748,
      "rows_before": 3430,
      "rows_after": 4870
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 4870,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-building-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 773,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "change_in_the_number_of_recruitment": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 28,
      "rows_after": 18
    },
    "error": null
  },
  {
    "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "estimated-workers.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 32,
      "rows_before": 3410,
      "rows_after": 3122
    },
    "error": null
  },
  {
    "file": "health-services.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 587,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "hotels-and-apartments.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 714,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "governorate": "governorate",
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "job-seekers.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 18,
      "rows_after": 22
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 28,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "number-of-job-seekers-by-highest-education-level.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 12,
      "rows_before": 22,
      "rows_after": 20
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-governorate-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "value-of-welfare-payments.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 99,
      "rows_before": 3122,
      "rows_after": 3130
    },
    "error": null
  },
  {
    "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3130,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  }
]

[2025-11-29 11:35:26] Ingest sequence finished

[2025-11-29 11:44:28] RUN: 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\venv\Scripts\python.exe' 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py' --run --dry
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
[ingest] Loaded schema overrides from C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\config\schemas.json
[ingest] Running ingest (dry=True) - incoming dir: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-sectoral-recruitment.csv
{
  "file": "01-sectoral-recruitment.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 80,
    "rows_before": 3410,
    "rows_after": 3126
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-workers-registered-at-civil-service-bureau.csv
{
  "file": "01-workers-registered-at-civil-service-bureau.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 568,
    "rows_before": 3410,
    "rows_after": 3690
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-area-by-island-2023.csv
{
  "file": "03-area-by-island-2023.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 36,
    "rows_before": 3410,
    "rows_after": 3158
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-expenditure-per-visitor.csv
{
  "file": "03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 3410,
    "rows_after": 3218
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\05-health-labour-force-by-sex.csv
{
  "file": "05-health-labour-force-by-sex.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 60,
    "rows_before": 3410,
    "rows_after": 3182
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\06-number-of-protected-homes.csv
{
  "file": "06-number-of-protected-homes.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "number": "count",
    "n": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 10,
    "rows_before": 20,
    "rows_after": 28
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value (1).csv
{
  "file": "09-annually-compensation-of-employees-cp-value (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3410,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value.csv
{
  "file": "09-annually-compensation-of-employees-cp-value.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3410,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T100502_c403f8_places-of-interest0.csv
{
  "file": "20251129T100502_c403f8_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csvC:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)

{
  "file": "20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T113523_55e220_places-of-interest0.csv
{
  "file": "20251129T113523_55e220_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T114428_6ac1ba_03-expenditure-per-visitor.csv
{
  "file": "20251129T114428_6ac1ba_03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 3410,
    "rows_after": 3218
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\22-deaths-by-age-groups.csv
{
  "file": "22-deaths-by-age-groups.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 1748,
    "rows_before": 3410,
    "rows_after": 4870
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system (1).csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system.csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-current-usage-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-ownership-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings.csv
{
  "file": "buildings.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 773,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment.csv
{
  "file": "change-in-the-number-of-recruitment.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "change_in_the_number_of_recruitment": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 18
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-households-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-of-average-households-by-governorate-and-nationality-of-households-.csv
{
  "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-population-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\estimated-workers.csv
{
  "file": "estimated-workers.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 32,
    "rows_before": 3410,
    "rows_after": 3122
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\health-services.csv
{
  "file": "health-services.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 587,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\hotels-and-apartments.csv
{
  "file": "hotels-and-apartments.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 714,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-governorate-census-2020.csv
{
  "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "governorate": "governorate",
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-occupancy-census-2020 (2).csv
{
  "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\job-seekers.csv
{
  "file": "job-seekers.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 22
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate.csv
{
  "file": "lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv
{
  "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 28,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\number-of-job-seekers-by-highest-education-level.csv
{
  "file": "number-of-job-seekers-by-highest-education-level.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 12,
    "rows_before": 20,
    "rows_after": 20
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\places-of-interest0.csv
{
  "file": "places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv
{
  "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-governorate-and-household-nationality-census-2020.csv
{
  "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-governorate-census-2020.csv
{
  "file": "private-households-by-household-size-and-governorate-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-housing-type-census-2020.csv
{
  "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020 (1).csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020.csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\value-of-welfare-payments.csv
{
  "file": "value-of-welfare-payments.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 99,
    "rows_before": 3410,
    "rows_after": 3130
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\work-injuries-for-workers-covered-by-social-insurance-system.csv
{
  "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv
{
  "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv
{
  "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Done. Summary:
[
  {
    "file": "01-sectoral-recruitment.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 80,
      "rows_before": 3410,
      "rows_after": 3126
    },
    "error": null
  },
  {
    "file": "01-workers-registered-at-civil-service-bureau.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 568,
      "rows_before": 3410,
      "rows_after": 3690
    },
    "error": null
  },
  {
    "file": "03-area-by-island-2023.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 36,
      "rows_before": 3410,
      "rows_after": 3158
    },
    "error": null
  },
  {
    "file": "03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 3410,
      "rows_after": 3218
    },
    "error": null
  },
  {
    "file": "05-health-labour-force-by-sex.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 60,
      "rows_before": 3410,
      "rows_after": 3182
    },
    "error": null
  },
  {
    "file": "06-number-of-protected-homes.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "number": "count",
      "n": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 10,
      "rows_before": 20,
      "rows_after": 28
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3410,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3410,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T100502_c403f8_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T113523_55e220_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "20251129T114428_6ac1ba_03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 3410,
      "rows_after": 3218
    },
    "error": null
  },
  {
    "file": "22-deaths-by-age-groups.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 1748,
      "rows_before": 3410,
      "rows_after": 4870
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-building-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 773,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "change_in_the_number_of_recruitment": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 18
    },
    "error": null
  },
  {
    "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "estimated-workers.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 32,
      "rows_before": 3410,
      "rows_after": 3122
    },
    "error": null
  },
  {
    "file": "health-services.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 587,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "hotels-and-apartments.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 714,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "governorate": "governorate",
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "job-seekers.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 22
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 28,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "number-of-job-seekers-by-highest-education-level.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 12,
      "rows_before": 20,
      "rows_after": 20
    },
    "error": null
  },
  {
    "file": "places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-governorate-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "value-of-welfare-payments.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 99,
      "rows_before": 3410,
      "rows_after": 3130
    },
    "error": null
  },
  {
    "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  }
]


[2025-11-29 11:44:29] RUN: 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\venv\Scripts\python.exe' 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py' --run
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
[ingest] Loaded schema overrides from C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\config\schemas.json
[ingest] Running ingest (dry=False) - incoming dir: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-sectoral-recruitment.csv
{
  "file": "01-sectoral-recruitment.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 80,
    "rows_before": 3410,
    "rows_after": 3126
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-workers-registered-at-civil-service-bureau.csv
{
  "file": "01-workers-registered-at-civil-service-bureau.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 568,
    "rows_before": 3126,
    "rows_after": 3690
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-area-by-island-2023.csv
{
  "file": "03-area-by-island-2023.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 36,
    "rows_before": 3690,
    "rows_after": 3158
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-expenditure-per-visitor.csv
{
  "file": "03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 3158,
    "rows_after": 3218
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\05-health-labour-force-by-sex.csv
{
  "file": "05-health-labour-force-by-sex.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 60,
    "rows_before": 3218,
    "rows_after": 3182
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\06-number-of-protected-homes.csv
{
  "file": "06-number-of-protected-homes.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "number": "count",
    "n": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 10,
    "rows_before": 20,
    "rows_after": 28
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value (1).csv
{
  "file": "09-annually-compensation-of-employees-cp-value (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3182,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value.csv
{
  "file": "09-annually-compensation-of-employees-cp-value.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3430,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T100502_c403f8_places-of-interest0.csv
{
  "file": "20251129T100502_c403f8_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csvC:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",

{
  "file": "20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T113523_55e220_places-of-interest0.csv
{
  "file": "20251129T113523_55e220_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T114428_6ac1ba_03-expenditure-per-visitor.csv
{
  "file": "20251129T114428_6ac1ba_03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 3430,
    "rows_after": 3218
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\22-deaths-by-age-groups.csv
{
  "file": "22-deaths-by-age-groups.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 1748,
    "rows_before": 3218,
    "rows_after": 4870
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system (1).csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 4870,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system.csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-current-usage-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-ownership-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings.csv
{
  "file": "buildings.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 773,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment.csv
{
  "file": "change-in-the-number-of-recruitment.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "change_in_the_number_of_recruitment": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 28,
    "rows_after": 18
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-households-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-of-average-households-by-governorate-and-nationality-of-households-.csv
{
  "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-population-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\estimated-workers.csv
{
  "file": "estimated-workers.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 32,
    "rows_before": 3410,
    "rows_after": 3122
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\health-services.csv
{
  "file": "health-services.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 587,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\hotels-and-apartments.csv
{
  "file": "hotels-and-apartments.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 714,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-governorate-census-2020.csv
{
  "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "governorate": "governorate",
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",

[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-occupancy-census-2020 (2).csv
{
  "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\job-seekers.csv
{
  "file": "job-seekers.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 18,
    "rows_after": 22
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate.csv
{
  "file": "lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv
{
  "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 28,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\number-of-job-seekers-by-highest-education-level.csv
{
  "file": "number-of-job-seekers-by-highest-education-level.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 12,
    "rows_before": 22,
    "rows_after": 20
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\places-of-interest0.csv
{
  "file": "places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv
{
  "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-governorate-and-household-nationality-census-2020.csv
{
  "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-governorate-census-2020.csv
{
  "file": "private-households-by-household-size-and-governorate-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-housing-type-census-2020.csv
{
  "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020 (1).csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020.csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\value-of-welfare-payments.csv
{
  "file": "value-of-welfare-payments.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 99,
    "rows_before": 3122,
    "rows_after": 3130
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\work-injuries-for-workers-covered-by-social-insurance-system.csv
{
  "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3130,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv
{
  "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv
{
  "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Done. Summary:
[
  {
    "file": "01-sectoral-recruitment.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 80,
      "rows_before": 3410,
      "rows_after": 3126
    },
    "error": null
  },
  {
    "file": "01-workers-registered-at-civil-service-bureau.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 568,
      "rows_before": 3126,
      "rows_after": 3690
    },
    "error": null
  },
  {
    "file": "03-area-by-island-2023.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 36,
      "rows_before": 3690,
      "rows_after": 3158
    },
    "error": null
  },
  {
    "file": "03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 3158,
      "rows_after": 3218
    },
    "error": null
  },
  {
    "file": "05-health-labour-force-by-sex.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 60,
      "rows_before": 3218,
      "rows_after": 3182
    },
    "error": null
  },
  {
    "file": "06-number-of-protected-homes.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "number": "count",
      "n": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 10,
      "rows_before": 20,
      "rows_after": 28
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3182,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3430,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T100502_c403f8_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T113523_55e220_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "20251129T114428_6ac1ba_03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 3430,
      "rows_after": 3218
    },
    "error": null
  },
  {
    "file": "22-deaths-by-age-groups.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 1748,
      "rows_before": 3218,
      "rows_after": 4870
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 4870,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-building-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 773,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "change_in_the_number_of_recruitment": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 28,
      "rows_after": 18
    },
    "error": null
  },
  {
    "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "estimated-workers.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 32,
      "rows_before": 3410,
      "rows_after": 3122
    },
    "error": null
  },
  {
    "file": "health-services.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 587,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "hotels-and-apartments.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 714,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "governorate": "governorate",
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "job-seekers.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 18,
      "rows_after": 22
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 28,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "number-of-job-seekers-by-highest-education-level.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 12,
      "rows_before": 22,
      "rows_after": 20
    },
    "error": null
  },
  {
    "file": "places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-governorate-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "value-of-welfare-payments.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 99,
      "rows_before": 3122,
      "rows_after": 3130
    },
    "error": null
  },
  {
    "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3130,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  }
]

[2025-11-29 11:44:31] Ingest sequence finished

[2025-11-30 10:20:16] RUN: 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\venv\Scripts\python.exe' 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py' --run --dry
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
[ingest] Loaded schema overrides from C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\config\schemas.json
[ingest] Running ingest (dry=True) - incoming dir: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-sectoral-recruitment.csv
{
  "file": "01-sectoral-recruitment.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 80,
    "rows_before": 3410,
    "rows_after": 3126
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-workers-registered-at-civil-service-bureau.csv
{
  "file": "01-workers-registered-at-civil-service-bureau.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 568,
    "rows_before": 3410,
    "rows_after": 3690
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-area-by-island-2023.csv
{
  "file": "03-area-by-island-2023.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 36,
    "rows_before": 3410,
    "rows_after": 3158
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-expenditure-per-visitor.csv
{
  "file": "03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 3410,
    "rows_after": 3218
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\05-health-labour-force-by-sex.csv
{
  "file": "05-health-labour-force-by-sex.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 60,
    "rows_before": 3410,
    "rows_after": 3182
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\06-number-of-protected-homes.csv
{
  "file": "06-number-of-protected-homes.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "number": "count",
    "n": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 10,
    "rows_before": 20,
    "rows_after": 28
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value (1).csv
{
  "file": "09-annually-compensation-of-employees-cp-value (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3410,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value.csv
{
  "file": "09-annually-compensation-of-employees-cp-value.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3410,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T100502_c403f8_places-of-interest0.csv
{
  "file": "20251129T100502_c403f8_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csvC:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)

{
  "file": "20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T113523_55e220_places-of-interest0.csv
{
  "file": "20251129T113523_55e220_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T114428_6ac1ba_03-expenditure-per-visitor.csv
{
  "file": "20251129T114428_6ac1ba_03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 3410,
    "rows_after": 3218
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251130T102016_6adb86_population-15-years-and-above-by-governorate-and-labour-force-participation-cens.csv
{
  "file": "20251130T102016_6adb86_population-15-years-and-above-by-governorate-and-labour-force-participation-cens.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\22-deaths-by-age-groups.csv
{
  "file": "22-deaths-by-age-groups.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 1748,
    "rows_before": 3410,
    "rows_after": 4870
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system (1).csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system.csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-current-usage-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-ownership-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings.csv
{
  "file": "buildings.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 773,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment.csv
{
  "file": "change-in-the-number-of-recruitment.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "change_in_the_number_of_recruitment": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 18
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-households-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-of-average-households-by-governorate-and-nationality-of-households-.csv
{
  "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-population-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\estimated-workers.csv
{
  "file": "estimated-workers.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 32,
    "rows_before": 3410,
    "rows_after": 3122
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\health-services.csv
{
  "file": "health-services.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 587,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\hotels-and-apartments.csv
{
  "file": "hotels-and-apartments.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 714,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-governorate-census-2020.csv
{
  "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "governorate": "governorate",
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-occupancy-census-2020 (2).csv
{
  "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\job-seekers.csv
{
  "file": "job-seekers.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 22
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate.csv
{
  "file": "lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv
{
  "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 28,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\number-of-job-seekers-by-highest-education-level.csv
{
  "file": "number-of-job-seekers-by-highest-education-level.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 12,
    "rows_before": 20,
    "rows_after": 20
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\places-of-interest0.csv
{
  "file": "places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv
{
  "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-governorate-and-household-nationality-census-2020.csv
{
  "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-governorate-census-2020.csv
{
  "file": "private-households-by-household-size-and-governorate-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-housing-type-census-2020.csv
{
  "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020 (1).csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020.csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\value-of-welfare-payments.csv
{
  "file": "value-of-welfare-payments.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 99,
    "rows_before": 3410,
    "rows_after": 3130
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\work-injuries-for-workers-covered-by-social-insurance-system.csv
{
  "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv
{
  "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv
{
  "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Done. Summary:
[
  {
    "file": "01-sectoral-recruitment.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 80,
      "rows_before": 3410,
      "rows_after": 3126
    },
    "error": null
  },
  {
    "file": "01-workers-registered-at-civil-service-bureau.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 568,
      "rows_before": 3410,
      "rows_after": 3690
    },
    "error": null
  },
  {
    "file": "03-area-by-island-2023.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 36,
      "rows_before": 3410,
      "rows_after": 3158
    },
    "error": null
  },
  {
    "file": "03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 3410,
      "rows_after": 3218
    },
    "error": null
  },
  {
    "file": "05-health-labour-force-by-sex.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 60,
      "rows_before": 3410,
      "rows_after": 3182
    },
    "error": null
  },
  {
    "file": "06-number-of-protected-homes.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "number": "count",
      "n": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 10,
      "rows_before": 20,
      "rows_after": 28
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3410,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3410,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T100502_c403f8_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T113523_55e220_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "20251129T114428_6ac1ba_03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 3410,
      "rows_after": 3218
    },
    "error": null
  },
  {
    "file": "20251130T102016_6adb86_population-15-years-and-above-by-governorate-and-labour-force-participation-cens.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "22-deaths-by-age-groups.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 1748,
      "rows_before": 3410,
      "rows_after": 4870
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-building-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 773,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "change_in_the_number_of_recruitment": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 18
    },
    "error": null
  },
  {
    "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "estimated-workers.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 32,
      "rows_before": 3410,
      "rows_after": 3122
    },
    "error": null
  },
  {
    "file": "health-services.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 587,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "hotels-and-apartments.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 714,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "governorate": "governorate",
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "job-seekers.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 22
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 28,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "number-of-job-seekers-by-highest-education-level.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 12,
      "rows_before": 20,
      "rows_after": 20
    },
    "error": null
  },
  {
    "file": "places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-governorate-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "value-of-welfare-payments.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 99,
      "rows_before": 3410,
      "rows_after": 3130
    },
    "error": null
  },
  {
    "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  }
]


[2025-11-30 10:20:17] RUN: 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\venv\Scripts\python.exe' 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py' --run
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
[ingest] Loaded schema overrides from C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\config\schemas.json
[ingest] Running ingest (dry=False) - incoming dir: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-sectoral-recruitment.csv
{
  "file": "01-sectoral-recruitment.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 80,
    "rows_before": 3410,
    "rows_after": 3126
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-workers-registered-at-civil-service-bureau.csv
{
  "file": "01-workers-registered-at-civil-service-bureau.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 568,
    "rows_before": 3126,
    "rows_after": 3690
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-area-by-island-2023.csv
{
  "file": "03-area-by-island-2023.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 36,
    "rows_before": 3690,
    "rows_after": 3158
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-expenditure-per-visitor.csv
{
  "file": "03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 3158,
    "rows_after": 3218
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\05-health-labour-force-by-sex.csv
{
  "file": "05-health-labour-force-by-sex.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 60,
    "rows_before": 3218,
    "rows_after": 3182
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\06-number-of-protected-homes.csv
{
  "file": "06-number-of-protected-homes.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "number": "count",
    "n": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 10,
    "rows_before": 20,
    "rows_after": 28
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value (1).csv
{
  "file": "09-annually-compensation-of-employees-cp-value (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3182,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value.csv
{
  "file": "09-annually-compensation-of-employees-cp-value.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3430,
    "rows_after": 3430
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T100502_c403f8_places-of-interest0.csv
{
  "file": "20251129T100502_c403f8_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csvC:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",

{
  "file": "20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T113523_55e220_places-of-interest0.csv
{
  "file": "20251129T113523_55e220_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T114428_6ac1ba_03-expenditure-per-visitor.csv
{
  "file": "20251129T114428_6ac1ba_03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 3430,
    "rows_after": 3218
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251130T102016_6adb86_population-15-years-and-above-by-governorate-and-labour-force-participation-cens.csv
{
  "file": "20251130T102016_6adb86_population-15-years-and-above-by-governorate-and-labour-force-participation-cens.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\22-deaths-by-age-groups.csv
{
  "file": "22-deaths-by-age-groups.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 1748,
    "rows_before": 3218,
    "rows_after": 4870
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system (1).csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 4870,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system.csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3410,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-current-usage-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-ownership-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings.csv
{
  "file": "buildings.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 773,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment.csv
{
  "file": "change-in-the-number-of-recruitment.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "change_in_the_number_of_recruitment": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 28,
    "rows_after": 18
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-households-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-of-average-households-by-governorate-and-nationality-of-households-.csv
{
  "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-population-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\estimated-workers.csv
{
  "file": "estimated-workers.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 32,
    "rows_before": 3410,
    "rows_after": 3122
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\health-services.csv
{
  "file": "health-services.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 587,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\hotels-and-apartments.csv
{
  "file": "hotels-and-apartments.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 714,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",

[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-governorate-census-2020.csv
{
  "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "governorate": "governorate",
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-occupancy-census-2020 (2).csv
{
  "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\job-seekers.csv
{
  "file": "job-seekers.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 18,
    "rows_after": 22
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate.csv
{
  "file": "lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv
{
  "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 28,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\number-of-job-seekers-by-highest-education-level.csv
{
  "file": "number-of-job-seekers-by-highest-education-level.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 12,
    "rows_before": 22,
    "rows_after": 20
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\places-of-interest0.csv
{
  "file": "places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2107,
    "rows_after": 2107
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv
{
  "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-governorate-and-household-nationality-census-2020.csv
{
  "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-governorate-census-2020.csv
{
  "file": "private-households-by-household-size-and-governorate-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-housing-type-census-2020.csv
{
  "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020 (1).csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020.csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\value-of-welfare-payments.csv
{
  "file": "value-of-welfare-payments.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 99,
    "rows_before": 3122,
    "rows_after": 3130
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\work-injuries-for-workers-covered-by-social-insurance-system.csv
{
  "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3130,
    "rows_after": 3410
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv
{
  "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv
{
  "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Done. Summary:
[
  {
    "file": "01-sectoral-recruitment.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 80,
      "rows_before": 3410,
      "rows_after": 3126
    },
    "error": null
  },
  {
    "file": "01-workers-registered-at-civil-service-bureau.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 568,
      "rows_before": 3126,
      "rows_after": 3690
    },
    "error": null
  },
  {
    "file": "03-area-by-island-2023.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 36,
      "rows_before": 3690,
      "rows_after": 3158
    },
    "error": null
  },
  {
    "file": "03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 3158,
      "rows_after": 3218
    },
    "error": null
  },
  {
    "file": "05-health-labour-force-by-sex.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 60,
      "rows_before": 3218,
      "rows_after": 3182
    },
    "error": null
  },
  {
    "file": "06-number-of-protected-homes.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "number": "count",
      "n": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 10,
      "rows_before": 20,
      "rows_after": 28
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3182,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3430,
      "rows_after": 3430
    },
    "error": null
  },
  {
    "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T100502_c403f8_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T113523_55e220_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "20251129T114428_6ac1ba_03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 3430,
      "rows_after": 3218
    },
    "error": null
  },
  {
    "file": "20251130T102016_6adb86_population-15-years-and-above-by-governorate-and-labour-force-participation-cens.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "22-deaths-by-age-groups.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 1748,
      "rows_before": 3218,
      "rows_after": 4870
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 4870,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3410,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-building-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 773,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "change_in_the_number_of_recruitment": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 28,
      "rows_after": 18
    },
    "error": null
  },
  {
    "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "estimated-workers.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 32,
      "rows_before": 3410,
      "rows_after": 3122
    },
    "error": null
  },
  {
    "file": "health-services.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 587,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "hotels-and-apartments.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 714,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "governorate": "governorate",
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "job-seekers.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 18,
      "rows_after": 22
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 28,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "number-of-job-seekers-by-highest-education-level.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 12,
      "rows_before": 22,
      "rows_after": 20
    },
    "error": null
  },
  {
    "file": "places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2107,
      "rows_after": 2107
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-governorate-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "value-of-welfare-payments.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 99,
      "rows_before": 3122,
      "rows_after": 3130
    },
    "error": null
  },
  {
    "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3130,
      "rows_after": 3410
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  }
]


[2025-11-30 10:25:56] RUN: 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\venv\Scripts\python.exe' 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py' --run --dry
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
[ingest] Loaded schema overrides from C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\config\schemas.json
[ingest] Running ingest (dry=True) - incoming dir: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-sectoral-recruitment.csv
{
  "file": "01-sectoral-recruitment.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 80,
    "rows_before": 3700,
    "rows_after": 3416
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-workers-registered-at-civil-service-bureau.csv
{
  "file": "01-workers-registered-at-civil-service-bureau.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 568,
    "rows_before": 3700,
    "rows_after": 3980
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-area-by-island-2023.csv
{
  "file": "03-area-by-island-2023.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 36,
    "rows_before": 3700,
    "rows_after": 3448
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-expenditure-per-visitor.csv
{
  "file": "03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 3700,
    "rows_after": 3508
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\04-unemployment-by-sex-and-age-group-yearly.csv
{
  "file": "04-unemployment-by-sex-and-age-group-yearly.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 290,
    "rows_before": 3700,
    "rows_after": 3702
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\05-health-labour-force-by-sex.csv
{
  "file": "05-health-labour-force-by-sex.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 60,
    "rows_before": 3700,
    "rows_after": 3472
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\06-number-of-protected-homes.csv
{
  "file": "06-number-of-protected-homes.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "number": "count",
    "n": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 10,
    "rows_before": 20,
    "rows_after": 28
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value (1).csv
{
  "file": "09-annually-compensation-of-employees-cp-value (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3700,
    "rows_after": 3720
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value.csv
{
  "file": "09-annually-compensation-of-employees-cp-value.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3700,
    "rows_after": 3720
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T100502_c403f8_places-of-interest0.csv
{
  "file": "20251129T100502_c403f8_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2108,
    "rows_after": 2108
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csvC:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)

{
  "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T113523_55e220_places-of-interest0.csv
{
  "file": "20251129T113523_55e220_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2108,
    "rows_after": 2108
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T114428_6ac1ba_03-expenditure-per-visitor.csv
{
  "file": "20251129T114428_6ac1ba_03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 3700,
    "rows_after": 3508
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251130T102016_6adb86_population-15-years-and-above-by-governorate-and-labour-force-participation-cens.csv
{
  "file": "20251130T102016_6adb86_population-15-years-and-above-by-governorate-and-labour-force-participation-cens.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251130T102556_bc366a_worldbank_bahrain_indicators_20251130T035803Z.csv
{
  "file": "20251130T102556_bc366a_worldbank_bahrain_indicators_20251130T035803Z.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "date": "date"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 260,
    "rows_before": 2108,
    "rows_after": 2109
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\22-deaths-by-age-groups.csv
{
  "file": "22-deaths-by-age-groups.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 1748,
    "rows_before": 3700,
    "rows_after": 5160
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system (1).csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3700,
    "rows_after": 3700
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system.csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3700,
    "rows_after": 3700
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\bahrain_worldbank_indicators_20251130T034233Z.csv
{
  "file": "bahrain_worldbank_indicators_20251130T034233Z.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "date": "date"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 325,
    "rows_before": 2108,
    "rows_after": 2109
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-current-usage-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-ownership-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings.csv
{
  "file": "buildings.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 773,
    "rows_before": 2108,
    "rows_after": 2108
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment-by-sectors.csv
{
  "file": "change-in-the-number-of-recruitment-by-sectors.csv",
  "detected_master": "students.csv",
  "mapping": {
    "year": "year",
    "sector": "sector"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 16,
    "rows_before": 52,
    "rows_after": 52
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment.csv
{
  "file": "change-in-the-number-of-recruitment.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "change_in_the_number_of_recruitment": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 18
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-households-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-of-average-households-by-governorate-and-nationality-of-households-.csvC:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)

{
  "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-population-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\estimated-workers.csv
{
  "file": "estimated-workers.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 32,
    "rows_before": 3700,
    "rows_after": 3412
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\health-services.csv
{
  "file": "health-services.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 587,
    "rows_before": 2108,
    "rows_after": 2108
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\hotels-and-apartments.csv
{
  "file": "hotels-and-apartments.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 714,
    "rows_before": 2108,
    "rows_after": 2108
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-governorate-census-2020.csv
{
  "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "governorate": "governorate",
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-occupancy-census-2020 (2).csv
{
  "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\job-seekers.csv
{
  "file": "job-seekers.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 20,
    "rows_after": 22
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate (1).csv
{
  "file": "lmra1-active-work-permits-for-expatriate (1).csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate.csv
{
  "file": "lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv
{
  "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 28,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\number-of-job-seekers-by-highest-education-level.csv
{
  "file": "number-of-job-seekers-by-highest-education-level.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 12,
    "rows_before": 20,
    "rows_after": 20
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\places-of-interest0.csv
{
  "file": "places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2108,
    "rows_after": 2108
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-governorate-and-labour-force-participation-cens.csv
{
  "file": "population-15-years-and-above-by-governorate-and-labour-force-participation-cens.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-labour-force-participation-nationality-and-sex-.csv
{
  "file": "population-15-years-and-above-by-labour-force-participation-nationality-and-sex-.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv
{
  "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-governorate-and-household-nationality-census-2020.csv
{
  "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-governorate-census-2020.csv
{
  "file": "private-households-by-household-size-and-governorate-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-housing-type-census-2020.csv
{
  "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020 (1).csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020.csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\value-of-welfare-payments.csv
{
  "file": "value-of-welfare-payments.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 99,
    "rows_before": 3700,
    "rows_after": 3420
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\work-injuries-for-workers-covered-by-social-insurance-system.csv
{
  "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3700,
    "rows_after": 3700
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv
{
  "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv
{
  "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Done. Summary:
[
  {
    "file": "01-sectoral-recruitment.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 80,
      "rows_before": 3700,
      "rows_after": 3416
    },
    "error": null
  },
  {
    "file": "01-workers-registered-at-civil-service-bureau.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 568,
      "rows_before": 3700,
      "rows_after": 3980
    },
    "error": null
  },
  {
    "file": "03-area-by-island-2023.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 36,
      "rows_before": 3700,
      "rows_after": 3448
    },
    "error": null
  },
  {
    "file": "03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 3700,
      "rows_after": 3508
    },
    "error": null
  },
  {
    "file": "04-unemployment-by-sex-and-age-group-yearly.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 290,
      "rows_before": 3700,
      "rows_after": 3702
    },
    "error": null
  },
  {
    "file": "05-health-labour-force-by-sex.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 60,
      "rows_before": 3700,
      "rows_after": 3472
    },
    "error": null
  },
  {
    "file": "06-number-of-protected-homes.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "number": "count",
      "n": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 10,
      "rows_before": 20,
      "rows_after": 28
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3700,
      "rows_after": 3720
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3700,
      "rows_after": 3720
    },
    "error": null
  },
  {
    "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T100502_c403f8_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2108,
      "rows_after": 2108
    },
    "error": null
  },
  {
    "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T113523_55e220_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2108,
      "rows_after": 2108
    },
    "error": null
  },
  {
    "file": "20251129T114428_6ac1ba_03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 3700,
      "rows_after": 3508
    },
    "error": null
  },
  {
    "file": "20251130T102016_6adb86_population-15-years-and-above-by-governorate-and-labour-force-participation-cens.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251130T102556_bc366a_worldbank_bahrain_indicators_20251130T035803Z.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "date": "date"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 260,
      "rows_before": 2108,
      "rows_after": 2109
    },
    "error": null
  },
  {
    "file": "22-deaths-by-age-groups.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 1748,
      "rows_before": 3700,
      "rows_after": 5160
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3700,
      "rows_after": 3700
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3700,
      "rows_after": 3700
    },
    "error": null
  },
  {
    "file": "bahrain_worldbank_indicators_20251130T034233Z.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "date": "date"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 325,
      "rows_before": 2108,
      "rows_after": 2109
    },
    "error": null
  },
  {
    "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-building-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 773,
      "rows_before": 2108,
      "rows_after": 2108
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment-by-sectors.csv",
    "detected_master": "students.csv",
    "mapping": {
      "year": "year",
      "sector": "sector"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 16,
      "rows_before": 52,
      "rows_after": 52
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "change_in_the_number_of_recruitment": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 18
    },
    "error": null
  },
  {
    "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "estimated-workers.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 32,
      "rows_before": 3700,
      "rows_after": 3412
    },
    "error": null
  },
  {
    "file": "health-services.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 587,
      "rows_before": 2108,
      "rows_after": 2108
    },
    "error": null
  },
  {
    "file": "hotels-and-apartments.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 714,
      "rows_before": 2108,
      "rows_after": 2108
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "governorate": "governorate",
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "job-seekers.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 20,
      "rows_after": 22
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate (1).csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 28,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "number-of-job-seekers-by-highest-education-level.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 12,
      "rows_before": 20,
      "rows_after": 20
    },
    "error": null
  },
  {
    "file": "places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2108,
      "rows_after": 2108
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-governorate-and-labour-force-participation-cens.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-labour-force-participation-nationality-and-sex-.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-governorate-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "value-of-welfare-payments.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 99,
      "rows_before": 3700,
      "rows_after": 3420
    },
    "error": null
  },
  {
    "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3700,
      "rows_after": 3700
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  }
]


[2025-11-30 10:25:57] RUN: 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\venv\Scripts\python.exe' 'C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py' --run
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
[ingest] Loaded schema overrides from C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\config\schemas.json
[ingest] Running ingest (dry=False) - incoming dir: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-sectoral-recruitment.csv
{
  "file": "01-sectoral-recruitment.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 80,
    "rows_before": 3700,
    "rows_after": 3416
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\01-workers-registered-at-civil-service-bureau.csv
{
  "file": "01-workers-registered-at-civil-service-bureau.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 568,
    "rows_before": 3416,
    "rows_after": 3980
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-area-by-island-2023.csv
{
  "file": "03-area-by-island-2023.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 36,
    "rows_before": 3980,
    "rows_after": 3448
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\03-expenditure-per-visitor.csv
{
  "file": "03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 3448,
    "rows_after": 3508
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\04-unemployment-by-sex-and-age-group-yearly.csv
{
  "file": "04-unemployment-by-sex-and-age-group-yearly.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 290,
    "rows_before": 3508,
    "rows_after": 3702
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\05-health-labour-force-by-sex.csv
{
  "file": "05-health-labour-force-by-sex.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 60,
    "rows_before": 3702,
    "rows_after": 3472
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\06-number-of-protected-homes.csv
{
  "file": "06-number-of-protected-homes.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "number": "count",
    "n": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 10,
    "rows_before": 20,
    "rows_after": 28
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value (1).csv
{
  "file": "09-annually-compensation-of-employees-cp-value (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3472,
    "rows_after": 3720
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\09-annually-compensation-of-employees-cp-value.csv
{
  "file": "09-annually-compensation-of-employees-cp-value.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 308,
    "rows_before": 3720,
    "rows_after": 3720
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20-hec_higher-education-institutes-by-sector-governorate.csv
{
  "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv
{
  "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
  "detected_master": "labour_master.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T100502_c403f8_places-of-interest0.csv
{
  "file": "20251129T100502_c403f8_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2108,
    "rows_after": 2108
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csvC:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",

{
  "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
  "detected_master": "higher_education.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "n": "students"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 48,
    "rows_before": 44,
    "rows_after": 44
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csv
{
  "file": "20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T113523_55e220_places-of-interest0.csv
{
  "file": "20251129T113523_55e220_places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2108,
    "rows_after": 2108
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251129T114428_6ac1ba_03-expenditure-per-visitor.csv
{
  "file": "20251129T114428_6ac1ba_03-expenditure-per-visitor.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 96,
    "rows_before": 3720,
    "rows_after": 3508
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251130T102016_6adb86_population-15-years-and-above-by-governorate-and-labour-force-participation-cens.csv
{
  "file": "20251130T102016_6adb86_population-15-years-and-above-by-governorate-and-labour-force-participation-cens.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\20251130T102556_bc366a_worldbank_bahrain_indicators_20251130T035803Z.csv
{
  "file": "20251130T102556_bc366a_worldbank_bahrain_indicators_20251130T035803Z.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "date": "date"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 260,
    "rows_before": 2108,
    "rows_after": 2109
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\22-deaths-by-age-groups.csv
{
  "file": "22-deaths-by-age-groups.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 1748,
    "rows_before": 3508,
    "rows_after": 5160
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system (1).csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 5160,
    "rows_after": 3700
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\absentees-for-workers-covered-by-social-insurance-system.csv
{
  "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3700,
    "rows_after": 3700
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\bahrain_worldbank_indicators_20251130T034233Z.csv
{
  "file": "bahrain_worldbank_indicators_20251130T034233Z.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "date": "date"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 325,
    "rows_before": 2109,
    "rows_after": 2109
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-current-usage-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-building-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-building-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings-by-ownership-type-and-governorate-census-2020.csv
{
  "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
  "detected_master": "households.csv",
  "mapping": {
    "governorate": "governorate"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\buildings.csv
{
  "file": "buildings.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 773,
    "rows_before": 2109,
    "rows_after": 2108
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment-by-sectors.csv
{
  "file": "change-in-the-number-of-recruitment-by-sectors.csv",
  "detected_master": "students.csv",
  "mapping": {
    "year": "year",
    "sector": "sector"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 16,
    "rows_before": 52,
    "rows_after": 52
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\change-in-the-number-of-recruitment.csv
{
  "file": "change-in-the-number-of-recruitment.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "sector": "sector",
    "change_in_the_number_of_recruitment": "count"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 28,
    "rows_after": 18
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-households-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-of-average-households-by-governorate-and-nationality-of-households-.csvC:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:526: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  merged = pd.concat([master_df, mapped_df], ignore_index=True, sort=False)
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",

{
  "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\distribution-population-by-governorate-and-nationality-of-households-census-2020.csv
{
  "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {},
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\estimated-workers.csv
{
  "file": "estimated-workers.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 32,
    "rows_before": 3700,
    "rows_after": 3412
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\health-services.csv
{
  "file": "health-services.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 587,
    "rows_before": 2108,
    "rows_after": 2108
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\hotels-and-apartments.csv
{
  "file": "hotels-and-apartments.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 714,
    "rows_before": 2108,
    "rows_after": 2108
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-governorate-census-2020.csv
{
  "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "governorate": "governorate",
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\housing-units-by-housing-type-and-occupancy-census-2020 (2).csv
{
  "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
  "detected_master": "housing_units.csv",
  "mapping": {
    "housing_type": "housing_type",
    "housing_unit": "units"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\job-seekers.csv
{
  "file": "job-seekers.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 8,
    "rows_before": 18,
    "rows_after": 22
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate (1).csv
{
  "file": "lmra1-active-work-permits-for-expatriate (1).csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra1-active-work-permits-for-expatriate.csv
{
  "file": "lmra1-active-work-permits-for-expatriate.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 14,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv
{
  "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
  "detected_master": "domestic_permits.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 28,
    "rows_before": 4,
    "rows_after": 4
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\number-of-job-seekers-by-highest-education-level.csv
{
  "file": "number-of-job-seekers-by-highest-education-level.csv",
  "detected_master": "workforce_distribution.csv",
  "mapping": {
    "year": "year",
    "job_seekers": "job_role"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 12,
    "rows_before": 22,
    "rows_after": 20
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\places-of-interest0.csv
{
  "file": "places-of-interest0.csv",
  "detected_master": "footfall.csv",
  "mapping": {
    "location": "area_name",
    "name": "area_name"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 155,
    "rows_before": 2108,
    "rows_after": 2108
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-governorate-and-labour-force-participation-cens.csv
{
  "file": "population-15-years-and-above-by-governorate-and-labour-force-participation-cens.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-labour-force-participation-nationality-and-sex-.csv
{
  "file": "population-15-years-and-above-by-labour-force-participation-nationality-and-sex-.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv
{
  "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "nationality": "nationality",
    "sex": "sex"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-governorate-and-household-nationality-census-2020.csv
{
  "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-governorate-census-2020.csv
{
  "file": "private-households-by-household-size-and-governorate-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:548: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\scripts\ingest_and_prepare.py:460: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "updated_at_utc": datetime.utcnow().isoformat() + "Z",

[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\private-households-by-household-size-and-housing-type-census-2020.csv
{
  "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020 (1).csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\total-households-by-governorate-and-type-of-household-census-2020.csv
{
  "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
  "detected_master": "employer_households.csv",
  "mapping": {
    "household": "household_id"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\value-of-welfare-payments.csv
{
  "file": "value-of-welfare-payments.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 99,
    "rows_before": 3412,
    "rows_after": 3420
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\work-injuries-for-workers-covered-by-social-insurance-system.csv
{
  "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
  "detected_master": "labour_master.csv",
  "mapping": {
    "year": "year",
    "nationality": "nationality",
    "n": "nationality"
  },
  "merge_stats": {
    "master_exists": true,
    "rows_incoming": 288,
    "rows_before": 3420,
    "rows_after": 3700
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv
{
  "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Processing: C:\Users\Rafiuzzaman0028\Desktop\bahrain_stats_agent\data\incoming\working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv
{
  "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
  "detected_master": "population_density.csv",
  "mapping": {
    "population": "population"
  },
  "merge_stats": {
    "master_exists": false,
    "rows_incoming": 0,
    "rows_before": 0,
    "rows_after": 0
  },
  "error": null
}
[ingest] Done. Summary:
[
  {
    "file": "01-sectoral-recruitment.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 80,
      "rows_before": 3700,
      "rows_after": 3416
    },
    "error": null
  },
  {
    "file": "01-workers-registered-at-civil-service-bureau.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 568,
      "rows_before": 3416,
      "rows_after": 3980
    },
    "error": null
  },
  {
    "file": "03-area-by-island-2023.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 36,
      "rows_before": 3980,
      "rows_after": 3448
    },
    "error": null
  },
  {
    "file": "03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 3448,
      "rows_after": 3508
    },
    "error": null
  },
  {
    "file": "04-unemployment-by-sex-and-age-group-yearly.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 290,
      "rows_before": 3508,
      "rows_after": 3702
    },
    "error": null
  },
  {
    "file": "05-health-labour-force-by-sex.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 60,
      "rows_before": 3702,
      "rows_after": 3472
    },
    "error": null
  },
  {
    "file": "06-number-of-protected-homes.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "number": "count",
      "n": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 10,
      "rows_before": 20,
      "rows_after": 28
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3472,
      "rows_after": 3720
    },
    "error": null
  },
  {
    "file": "09-annually-compensation-of-employees-cp-value.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 308,
      "rows_before": 3720,
      "rows_after": 3720
    },
    "error": null
  },
  {
    "file": "20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T090818_444605_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090824_9438c5_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090829_293a53_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T090837_af04d6_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T092043_73cbc8_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T092047_d76a5b_2011_LabourAccounting_2002to2011_1.csv",
    "detected_master": "labour_master.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251129T100502_c403f8_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2108,
      "rows_after": 2108
    },
    "error": null
  },
  {
    "file": "20251129T110208_f4f2f1_20-hec_higher-education-institutes-by-sector-governorate.csv",
    "detected_master": "higher_education.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "n": "students"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 48,
      "rows_before": 44,
      "rows_after": 44
    },
    "error": null
  },
  {
    "file": "20251129T111911_5c9cc0_lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "20251129T113523_55e220_places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2108,
      "rows_after": 2108
    },
    "error": null
  },
  {
    "file": "20251129T114428_6ac1ba_03-expenditure-per-visitor.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 96,
      "rows_before": 3720,
      "rows_after": 3508
    },
    "error": null
  },
  {
    "file": "20251130T102016_6adb86_population-15-years-and-above-by-governorate-and-labour-force-participation-cens.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "20251130T102556_bc366a_worldbank_bahrain_indicators_20251130T035803Z.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "date": "date"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 260,
      "rows_before": 2108,
      "rows_after": 2109
    },
    "error": null
  },
  {
    "file": "22-deaths-by-age-groups.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 1748,
      "rows_before": 3508,
      "rows_after": 5160
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system (1).csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 5160,
      "rows_after": 3700
    },
    "error": null
  },
  {
    "file": "absentees-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3700,
      "rows_after": 3700
    },
    "error": null
  },
  {
    "file": "bahrain_worldbank_indicators_20251130T034233Z.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "date": "date"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 325,
      "rows_before": 2109,
      "rows_after": 2109
    },
    "error": null
  },
  {
    "file": "buildings-by-building-current-usage-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-building-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings-by-ownership-type-and-governorate-census-2020.csv",
    "detected_master": "households.csv",
    "mapping": {
      "governorate": "governorate"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "buildings.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 773,
      "rows_before": 2109,
      "rows_after": 2108
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment-by-sectors.csv",
    "detected_master": "students.csv",
    "mapping": {
      "year": "year",
      "sector": "sector"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 16,
      "rows_before": 52,
      "rows_after": 52
    },
    "error": null
  },
  {
    "file": "change-in-the-number-of-recruitment.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "sector": "sector",
      "change_in_the_number_of_recruitment": "count"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 28,
      "rows_after": 18
    },
    "error": null
  },
  {
    "file": "distribution-households-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-of-average-households-by-governorate-and-nationality-of-households-.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "distribution-population-by-governorate-and-nationality-of-households-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {},
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "estimated-workers.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 32,
      "rows_before": 3700,
      "rows_after": 3412
    },
    "error": null
  },
  {
    "file": "health-services.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 587,
      "rows_before": 2108,
      "rows_after": 2108
    },
    "error": null
  },
  {
    "file": "hotels-and-apartments.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 714,
      "rows_before": 2108,
      "rows_after": 2108
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-governorate-census-2020.csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "governorate": "governorate",
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "housing-units-by-housing-type-and-occupancy-census-2020 (2).csv",
    "detected_master": "housing_units.csv",
    "mapping": {
      "housing_type": "housing_type",
      "housing_unit": "units"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "job-seekers.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 8,
      "rows_before": 18,
      "rows_after": 22
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate (1).csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra1-active-work-permits-for-expatriate.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 14,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "lmra2-new-work-permits-and-renewal-of-work-permits-by-transaction-type.csv",
    "detected_master": "domestic_permits.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 28,
      "rows_before": 4,
      "rows_after": 4
    },
    "error": null
  },
  {
    "file": "number-of-job-seekers-by-highest-education-level.csv",
    "detected_master": "workforce_distribution.csv",
    "mapping": {
      "year": "year",
      "job_seekers": "job_role"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 12,
      "rows_before": 22,
      "rows_after": 20
    },
    "error": null
  },
  {
    "file": "places-of-interest0.csv",
    "detected_master": "footfall.csv",
    "mapping": {
      "location": "area_name",
      "name": "area_name"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 155,
      "rows_before": 2108,
      "rows_after": 2108
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-governorate-and-labour-force-participation-cens.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-labour-force-participation-nationality-and-sex-.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "population-15-years-and-above-by-sex-labour-force-participation-and-marital-stat.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "nationality": "nationality",
      "sex": "sex"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-governorate-and-household-nationality-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-governorate-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "private-households-by-household-size-and-housing-type-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020 (1).csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "total-households-by-governorate-and-type-of-household-census-2020.csv",
    "detected_master": "employer_households.csv",
    "mapping": {
      "household": "household_id"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "value-of-welfare-payments.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 99,
      "rows_before": 3412,
      "rows_after": 3420
    },
    "error": null
  },
  {
    "file": "work-injuries-for-workers-covered-by-social-insurance-system.csv",
    "detected_master": "labour_master.csv",
    "mapping": {
      "year": "year",
      "nationality": "nationality",
      "n": "nationality"
    },
    "merge_stats": {
      "master_exists": true,
      "rows_incoming": 288,
      "rows_before": 3420,
      "rows_after": 3700
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-age-groups-and-employment-status-census.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  },
  {
    "file": "working-population-15-years-and-above-by-employment-status-nationality-and-sex-c.csv",
    "detected_master": "population_density.csv",
    "mapping": {
      "population": "population"
    },
    "merge_stats": {
      "master_exists": false,
      "rows_incoming": 0,
      "rows_before": 0,
      "rows_after": 0
    },
    "error": null
  }
]

